import{a0 as Sn,a1 as xn,a2 as Bt,a3 as Vt,a4 as Jn,a5 as Un,U as Kn,V as P,Y as le,P as ge,a6 as Ee,Z as St,e as k,X as fe,a7 as de,a8 as Tt,a9 as Me,aa as Ke,f as U,ab as Wt,ac as pt,ad as zt,w as Pe,ae as V,af as kn,ag as Nn,O as Se,j as qt,ah as _n,v as xe,ai as Xn,aj as $t,ak as en,al as ke,am as jn,an as st,L as tn,ao as nn,D as Qn,ap as Ne,B as Fe,aq as sn,M as rn,g as Yn,o as on,ar as Zn,as as Vn,G as Je,at as Y,au as an,av as cn,aw as ft,ax as ln,l as w,ay as Wn,az as zn,aA as qn,aB as $n,aC as dt,aD as es,aE as ts,aF as ns,aG as ss,aH as qe,aI as mt,aJ as Ct,aK as gt,K as rs,aL as os,aM as is,aN as $e,n as as,h as rt,b as cs,aO as ls,aP as As,F as me,aQ as us,aR as hs,E as Oe}from"./three-CpHAp9iq.js";const An=parseInt(Sn.replace(/\D+/g,"")),Bs=An>=125?"uv1":"uv2";function xt(u,e){if(e===xn)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),u;if(e===Bt||e===Vt){let n=u.getIndex();if(n===null){const o=[],a=u.getAttribute("position");if(a!==void 0){for(let i=0;i<a.count;i++)o.push(i);u.setIndex(o),n=u.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),u}const t=n.count-2,s=[];if(n)if(e===Bt)for(let o=1;o<=t;o++)s.push(n.getX(0)),s.push(n.getX(o)),s.push(n.getX(o+1));else for(let o=0;o<t;o++)o%2===0?(s.push(n.getX(o)),s.push(n.getX(o+1)),s.push(n.getX(o+2))):(s.push(n.getX(o+2)),s.push(n.getX(o+1)),s.push(n.getX(o)));s.length/3!==t&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=u.clone();return r.setIndex(s),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),u}var _=Uint8Array,Ae=Uint16Array,Et=Uint32Array,un=new _([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hn=new _([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ps=new _([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Bn=function(u,e){for(var n=new Ae(31),t=0;t<31;++t)n[t]=e+=1<<u[t-1];for(var s=new Et(n[30]),t=1;t<30;++t)for(var r=n[t];r<n[t+1];++r)s[r]=r-n[t]<<5|t;return[n,s]},pn=Bn(un,2),fn=pn[0],fs=pn[1];fn[28]=258,fs[258]=28;var ds=Bn(hn,0),ms=ds[0],Ft=new Ae(32768);for(var O=0;O<32768;++O){var ae=(O&43690)>>>1|(O&21845)<<1;ae=(ae&52428)>>>2|(ae&13107)<<2,ae=(ae&61680)>>>4|(ae&3855)<<4,Ft[O]=((ae&65280)>>>8|(ae&255)<<8)>>>1}var Ue=function(u,e,n){for(var t=u.length,s=0,r=new Ae(e);s<t;++s)++r[u[s]-1];var o=new Ae(e);for(s=0;s<e;++s)o[s]=o[s-1]+r[s-1]<<1;var a;if(n){a=new Ae(1<<e);var i=15-e;for(s=0;s<t;++s)if(u[s])for(var l=s<<4|u[s],A=e-u[s],c=o[u[s]-1]++<<A,h=c|(1<<A)-1;c<=h;++c)a[Ft[c]>>>i]=l}else for(a=new Ae(t),s=0;s<t;++s)u[s]&&(a[s]=Ft[o[u[s]-1]++]>>>15-u[s]);return a},_e=new _(288);for(var O=0;O<144;++O)_e[O]=8;for(var O=144;O<256;++O)_e[O]=9;for(var O=256;O<280;++O)_e[O]=7;for(var O=280;O<288;++O)_e[O]=8;var dn=new _(32);for(var O=0;O<32;++O)dn[O]=5;var Cs=Ue(_e,9,1),gs=Ue(dn,5,1),ot=function(u){for(var e=u[0],n=1;n<u.length;++n)u[n]>e&&(e=u[n]);return e},Q=function(u,e,n){var t=e/8|0;return(u[t]|u[t+1]<<8)>>(e&7)&n},it=function(u,e){var n=e/8|0;return(u[n]|u[n+1]<<8|u[n+2]<<16)>>(e&7)},Es=function(u){return(u/8|0)+(u&7&&1)},Fs=function(u,e,n){(n==null||n>u.length)&&(n=u.length);var t=new(u instanceof Ae?Ae:u instanceof Et?Et:_)(n-e);return t.set(u.subarray(e,n)),t},Ms=function(u,e,n){var t=u.length;if(!t||n&&!n.l&&t<5)return e||new _(0);var s=!e||n,r=!n||n.i;n||(n={}),e||(e=new _(t*3));var o=function(je){var Qe=e.length;if(je>Qe){var Ye=new _(Math.max(Qe*2,je));Ye.set(e),e=Ye}},a=n.f||0,i=n.p||0,l=n.b||0,A=n.l,c=n.d,h=n.m,B=n.n,f=t*8;do{if(!A){n.f=a=Q(u,i,1);var d=Q(u,i+1,3);if(i+=3,d)if(d==1)A=Cs,c=gs,h=9,B=5;else if(d==2){var F=Q(u,i,31)+257,M=Q(u,i+10,15)+4,b=F+Q(u,i+5,31)+1;i+=14;for(var G=new _(b),H=new _(19),v=0;v<M;++v)H[ps[v]]=Q(u,i+v*3,7);i+=M*3;for(var S=ot(H),I=(1<<S)-1,Z=Ue(H,S,1),v=0;v<b;){var se=Z[Q(u,i,I)];i+=se&15;var m=se>>>4;if(m<16)G[v++]=m;else{var X=0,re=0;for(m==16?(re=3+Q(u,i,3),i+=2,X=G[v-1]):m==17?(re=3+Q(u,i,7),i+=3):m==18&&(re=11+Q(u,i,127),i+=7);re--;)G[v++]=X}}var De=G.subarray(0,F),j=G.subarray(F);h=ot(De),B=ot(j),A=Ue(De,h,1),c=Ue(j,B,1)}else throw"invalid block type";else{var m=Es(i)+4,g=u[m-4]|u[m-3]<<8,E=m+g;if(E>t){if(r)throw"unexpected EOF";break}s&&o(l+g),e.set(u.subarray(m,E),l),n.b=l+=g,n.p=i=E*8;continue}if(i>f){if(r)throw"unexpected EOF";break}}s&&o(l+131072);for(var Xe=(1<<h)-1,oe=(1<<B)-1,ue=i;;ue=i){var X=A[it(u,i)&Xe],W=X>>>4;if(i+=X&15,i>f){if(r)throw"unexpected EOF";break}if(!X)throw"invalid length/literal";if(W<256)e[l++]=W;else if(W==256){ue=i,A=null;break}else{var Ge=W-254;if(W>264){var v=W-257,z=un[v];Ge=Q(u,i,(1<<z)-1)+fn[v],i+=z}var pe=c[it(u,i)&oe],ye=pe>>>4;if(!pe)throw"invalid distance";i+=pe&15;var j=ms[ye];if(ye>3){var z=hn[ye];j+=it(u,i)&(1<<z)-1,i+=z}if(i>f){if(r)throw"unexpected EOF";break}s&&o(l+131072);for(var Re=l+Ge;l<Re;l+=4)e[l]=e[l-j],e[l+1]=e[l+1-j],e[l+2]=e[l+2-j],e[l+3]=e[l+3-j];l=Re}}n.l=A,n.p=ue,n.b=l,A&&(a=1,n.m=h,n.d=c,n.n=B)}while(!a);return l==e.length?e:Fs(e,0,l)},Is=new _(0),Ts=function(u){if((u[0]&15)!=8||u[0]>>>4>7||(u[0]<<8|u[1])%31)throw"invalid zlib data";if(u[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Ds(u,e){return Ms((Ts(u),u.subarray(2,-4)),e)}var Gs=typeof TextDecoder<"u"&&new TextDecoder,ys=0;try{Gs.decode(Is,{stream:!0}),ys=1}catch{}var Rs=Object.defineProperty,bs=(u,e,n)=>e in u?Rs(u,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):u[e]=n,T=(u,e,n)=>(bs(u,typeof e!="symbol"?e+"":e,n),n);const Ve=new Jn,Jt=new Un,vs=Math.cos(70*(Math.PI/180)),Ut=(u,e)=>(u%e+e)%e;class wr extends Kn{constructor(e,n){super(),T(this,"object"),T(this,"domElement"),T(this,"enabled",!0),T(this,"target",new P),T(this,"minDistance",0),T(this,"maxDistance",1/0),T(this,"minZoom",0),T(this,"maxZoom",1/0),T(this,"minPolarAngle",0),T(this,"maxPolarAngle",Math.PI),T(this,"minAzimuthAngle",-1/0),T(this,"maxAzimuthAngle",1/0),T(this,"enableDamping",!1),T(this,"dampingFactor",.05),T(this,"enableZoom",!0),T(this,"zoomSpeed",1),T(this,"enableRotate",!0),T(this,"rotateSpeed",1),T(this,"enablePan",!0),T(this,"panSpeed",1),T(this,"screenSpacePanning",!0),T(this,"keyPanSpeed",7),T(this,"zoomToCursor",!1),T(this,"autoRotate",!1),T(this,"autoRotateSpeed",2),T(this,"reverseOrbit",!1),T(this,"reverseHorizontalOrbit",!1),T(this,"reverseVerticalOrbit",!1),T(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),T(this,"mouseButtons",{LEFT:fe.ROTATE,MIDDLE:fe.DOLLY,RIGHT:fe.PAN}),T(this,"touches",{ONE:de.ROTATE,TWO:de.DOLLY_PAN}),T(this,"target0"),T(this,"position0"),T(this,"zoom0"),T(this,"_domElementKeyEvents",null),T(this,"getPolarAngle"),T(this,"getAzimuthalAngle"),T(this,"setPolarAngle"),T(this,"setAzimuthalAngle"),T(this,"getDistance"),T(this,"listenToKeyEvents"),T(this,"stopListenToKeyEvents"),T(this,"saveState"),T(this,"reset"),T(this,"update"),T(this,"connect"),T(this,"dispose"),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>A.phi,this.getAzimuthalAngle=()=>A.theta,this.setPolarAngle=p=>{let C=Ut(p,2*Math.PI),D=A.phi;D<0&&(D+=2*Math.PI),C<0&&(C+=2*Math.PI);let L=Math.abs(C-D);2*Math.PI-L<L&&(C<D?C+=2*Math.PI:D+=2*Math.PI),c.phi=C-D,t.update()},this.setAzimuthalAngle=p=>{let C=Ut(p,2*Math.PI),D=A.theta;D<0&&(D+=2*Math.PI),C<0&&(C+=2*Math.PI);let L=Math.abs(C-D);2*Math.PI-L<L&&(C<D?C+=2*Math.PI:D+=2*Math.PI),c.theta=C-D,t.update()},this.getDistance=()=>t.object.position.distanceTo(t.target),this.listenToKeyEvents=p=>{p.addEventListener("keydown",tt),this._domElementKeyEvents=p},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",tt),this._domElementKeyEvents=null},this.saveState=()=>{t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=()=>{t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(s),t.update(),i=a.NONE},this.update=(()=>{const p=new P,C=new P(0,1,0),D=new le().setFromUnitVectors(e.up,C),L=D.clone().invert(),J=new P,q=new le,ie=2*Math.PI;return function(){const Ot=t.object.position;D.setFromUnitVectors(e.up,C),L.copy(D).invert(),p.copy(Ot).sub(t.target),p.applyQuaternion(D),A.setFromVector3(p),t.autoRotate&&i===a.NONE&&re(se()),t.enableDamping?(A.theta+=c.theta*t.dampingFactor,A.phi+=c.phi*t.dampingFactor):(A.theta+=c.theta,A.phi+=c.phi);let $=t.minAzimuthAngle,ee=t.maxAzimuthAngle;isFinite($)&&isFinite(ee)&&($<-Math.PI?$+=ie:$>Math.PI&&($-=ie),ee<-Math.PI?ee+=ie:ee>Math.PI&&(ee-=ie),$<=ee?A.theta=Math.max($,Math.min(ee,A.theta)):A.theta=A.theta>($+ee)/2?Math.max($,A.theta):Math.min(ee,A.theta)),A.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,A.phi)),A.makeSafe(),t.enableDamping===!0?t.target.addScaledVector(B,t.dampingFactor):t.target.add(B),t.zoomToCursor&&S||t.object.isOrthographicCamera?A.radius=z(A.radius):A.radius=z(A.radius*h),p.setFromSpherical(A),p.applyQuaternion(L),Ot.copy(t.target).add(p),t.object.matrixAutoUpdate||t.object.updateMatrix(),t.object.lookAt(t.target),t.enableDamping===!0?(c.theta*=1-t.dampingFactor,c.phi*=1-t.dampingFactor,B.multiplyScalar(1-t.dampingFactor)):(c.set(0,0,0),B.set(0,0,0));let ve=!1;if(t.zoomToCursor&&S){let Le=null;if(t.object instanceof ge&&t.object.isPerspectiveCamera){const He=p.length();Le=z(He*h);const Ze=He-Le;t.object.position.addScaledVector(H,Ze),t.object.updateMatrixWorld()}else if(t.object.isOrthographicCamera){const He=new P(v.x,v.y,0);He.unproject(t.object),t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/h)),t.object.updateProjectionMatrix(),ve=!0;const Ze=new P(v.x,v.y,0);Ze.unproject(t.object),t.object.position.sub(Ze).add(He),t.object.updateMatrixWorld(),Le=p.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),t.zoomToCursor=!1;Le!==null&&(t.screenSpacePanning?t.target.set(0,0,-1).transformDirection(t.object.matrix).multiplyScalar(Le).add(t.object.position):(Ve.origin.copy(t.object.position),Ve.direction.set(0,0,-1).transformDirection(t.object.matrix),Math.abs(t.object.up.dot(Ve.direction))<vs?e.lookAt(t.target):(Jt.setFromNormalAndCoplanarPoint(t.object.up,t.target),Ve.intersectPlane(Jt,t.target))))}else t.object instanceof Ee&&t.object.isOrthographicCamera&&(ve=h!==1,ve&&(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/h)),t.object.updateProjectionMatrix()));return h=1,S=!1,ve||J.distanceToSquared(t.object.position)>l||8*(1-q.dot(t.object.quaternion))>l?(t.dispatchEvent(s),J.copy(t.object.position),q.copy(t.object.quaternion),ve=!1,!0):!1}})(),this.connect=p=>{t.domElement=p,t.domElement.style.touchAction="none",t.domElement.addEventListener("contextmenu",wt),t.domElement.addEventListener("pointerdown",Lt),t.domElement.addEventListener("pointercancel",be),t.domElement.addEventListener("wheel",Ht)},this.dispose=()=>{var p,C,D,L,J,q;t.domElement&&(t.domElement.style.touchAction="auto"),(p=t.domElement)==null||p.removeEventListener("contextmenu",wt),(C=t.domElement)==null||C.removeEventListener("pointerdown",Lt),(D=t.domElement)==null||D.removeEventListener("pointercancel",be),(L=t.domElement)==null||L.removeEventListener("wheel",Ht),(J=t.domElement)==null||J.ownerDocument.removeEventListener("pointermove",et),(q=t.domElement)==null||q.ownerDocument.removeEventListener("pointerup",be),t._domElementKeyEvents!==null&&t._domElementKeyEvents.removeEventListener("keydown",tt)};const t=this,s={type:"change"},r={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let i=a.NONE;const l=1e-6,A=new St,c=new St;let h=1;const B=new P,f=new k,d=new k,m=new k,g=new k,E=new k,F=new k,M=new k,b=new k,G=new k,H=new P,v=new k;let S=!1;const I=[],Z={};function se(){return 2*Math.PI/60/60*t.autoRotateSpeed}function X(){return Math.pow(.95,t.zoomSpeed)}function re(p){t.reverseOrbit||t.reverseHorizontalOrbit?c.theta+=p:c.theta-=p}function De(p){t.reverseOrbit||t.reverseVerticalOrbit?c.phi+=p:c.phi-=p}const j=(()=>{const p=new P;return function(D,L){p.setFromMatrixColumn(L,0),p.multiplyScalar(-D),B.add(p)}})(),Xe=(()=>{const p=new P;return function(D,L){t.screenSpacePanning===!0?p.setFromMatrixColumn(L,1):(p.setFromMatrixColumn(L,0),p.crossVectors(t.object.up,p)),p.multiplyScalar(D),B.add(p)}})(),oe=(()=>{const p=new P;return function(D,L){const J=t.domElement;if(J&&t.object instanceof ge&&t.object.isPerspectiveCamera){const q=t.object.position;p.copy(q).sub(t.target);let ie=p.length();ie*=Math.tan(t.object.fov/2*Math.PI/180),j(2*D*ie/J.clientHeight,t.object.matrix),Xe(2*L*ie/J.clientHeight,t.object.matrix)}else J&&t.object instanceof Ee&&t.object.isOrthographicCamera?(j(D*(t.object.right-t.object.left)/t.object.zoom/J.clientWidth,t.object.matrix),Xe(L*(t.object.top-t.object.bottom)/t.object.zoom/J.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}})();function ue(p){t.object instanceof ge&&t.object.isPerspectiveCamera||t.object instanceof Ee&&t.object.isOrthographicCamera?h/=p:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function W(p){t.object instanceof ge&&t.object.isPerspectiveCamera||t.object instanceof Ee&&t.object.isOrthographicCamera?h*=p:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function Ge(p){if(!t.zoomToCursor||!t.domElement)return;S=!0;const C=t.domElement.getBoundingClientRect(),D=p.clientX-C.left,L=p.clientY-C.top,J=C.width,q=C.height;v.x=D/J*2-1,v.y=-(L/q)*2+1,H.set(v.x,v.y,1).unproject(t.object).sub(t.object.position).normalize()}function z(p){return Math.max(t.minDistance,Math.min(t.maxDistance,p))}function pe(p){f.set(p.clientX,p.clientY)}function ye(p){Ge(p),M.set(p.clientX,p.clientY)}function Re(p){g.set(p.clientX,p.clientY)}function je(p){d.set(p.clientX,p.clientY),m.subVectors(d,f).multiplyScalar(t.rotateSpeed);const C=t.domElement;C&&(re(2*Math.PI*m.x/C.clientHeight),De(2*Math.PI*m.y/C.clientHeight)),f.copy(d),t.update()}function Qe(p){b.set(p.clientX,p.clientY),G.subVectors(b,M),G.y>0?ue(X()):G.y<0&&W(X()),M.copy(b),t.update()}function Ye(p){E.set(p.clientX,p.clientY),F.subVectors(E,g).multiplyScalar(t.panSpeed),oe(F.x,F.y),g.copy(E),t.update()}function Tn(p){Ge(p),p.deltaY<0?W(X()):p.deltaY>0&&ue(X()),t.update()}function Dn(p){let C=!1;switch(p.code){case t.keys.UP:oe(0,t.keyPanSpeed),C=!0;break;case t.keys.BOTTOM:oe(0,-t.keyPanSpeed),C=!0;break;case t.keys.LEFT:oe(t.keyPanSpeed,0),C=!0;break;case t.keys.RIGHT:oe(-t.keyPanSpeed,0),C=!0;break}C&&(p.preventDefault(),t.update())}function Dt(){if(I.length==1)f.set(I[0].pageX,I[0].pageY);else{const p=.5*(I[0].pageX+I[1].pageX),C=.5*(I[0].pageY+I[1].pageY);f.set(p,C)}}function Gt(){if(I.length==1)g.set(I[0].pageX,I[0].pageY);else{const p=.5*(I[0].pageX+I[1].pageX),C=.5*(I[0].pageY+I[1].pageY);g.set(p,C)}}function yt(){const p=I[0].pageX-I[1].pageX,C=I[0].pageY-I[1].pageY,D=Math.sqrt(p*p+C*C);M.set(0,D)}function Gn(){t.enableZoom&&yt(),t.enablePan&&Gt()}function yn(){t.enableZoom&&yt(),t.enableRotate&&Dt()}function Rt(p){if(I.length==1)d.set(p.pageX,p.pageY);else{const D=nt(p),L=.5*(p.pageX+D.x),J=.5*(p.pageY+D.y);d.set(L,J)}m.subVectors(d,f).multiplyScalar(t.rotateSpeed);const C=t.domElement;C&&(re(2*Math.PI*m.x/C.clientHeight),De(2*Math.PI*m.y/C.clientHeight)),f.copy(d)}function bt(p){if(I.length==1)E.set(p.pageX,p.pageY);else{const C=nt(p),D=.5*(p.pageX+C.x),L=.5*(p.pageY+C.y);E.set(D,L)}F.subVectors(E,g).multiplyScalar(t.panSpeed),oe(F.x,F.y),g.copy(E)}function vt(p){const C=nt(p),D=p.pageX-C.x,L=p.pageY-C.y,J=Math.sqrt(D*D+L*L);b.set(0,J),G.set(0,Math.pow(b.y/M.y,t.zoomSpeed)),ue(G.y),M.copy(b)}function Rn(p){t.enableZoom&&vt(p),t.enablePan&&bt(p)}function bn(p){t.enableZoom&&vt(p),t.enableRotate&&Rt(p)}function Lt(p){var C,D;t.enabled!==!1&&(I.length===0&&((C=t.domElement)==null||C.ownerDocument.addEventListener("pointermove",et),(D=t.domElement)==null||D.ownerDocument.addEventListener("pointerup",be)),Pn(p),p.pointerType==="touch"?Hn(p):vn(p))}function et(p){t.enabled!==!1&&(p.pointerType==="touch"?wn(p):Ln(p))}function be(p){var C,D,L;On(p),I.length===0&&((C=t.domElement)==null||C.releasePointerCapture(p.pointerId),(D=t.domElement)==null||D.ownerDocument.removeEventListener("pointermove",et),(L=t.domElement)==null||L.ownerDocument.removeEventListener("pointerup",be)),t.dispatchEvent(o),i=a.NONE}function vn(p){let C;switch(p.button){case 0:C=t.mouseButtons.LEFT;break;case 1:C=t.mouseButtons.MIDDLE;break;case 2:C=t.mouseButtons.RIGHT;break;default:C=-1}switch(C){case fe.DOLLY:if(t.enableZoom===!1)return;ye(p),i=a.DOLLY;break;case fe.ROTATE:if(p.ctrlKey||p.metaKey||p.shiftKey){if(t.enablePan===!1)return;Re(p),i=a.PAN}else{if(t.enableRotate===!1)return;pe(p),i=a.ROTATE}break;case fe.PAN:if(p.ctrlKey||p.metaKey||p.shiftKey){if(t.enableRotate===!1)return;pe(p),i=a.ROTATE}else{if(t.enablePan===!1)return;Re(p),i=a.PAN}break;default:i=a.NONE}i!==a.NONE&&t.dispatchEvent(r)}function Ln(p){if(t.enabled!==!1)switch(i){case a.ROTATE:if(t.enableRotate===!1)return;je(p);break;case a.DOLLY:if(t.enableZoom===!1)return;Qe(p);break;case a.PAN:if(t.enablePan===!1)return;Ye(p);break}}function Ht(p){t.enabled===!1||t.enableZoom===!1||i!==a.NONE&&i!==a.ROTATE||(p.preventDefault(),t.dispatchEvent(r),Tn(p),t.dispatchEvent(o))}function tt(p){t.enabled===!1||t.enablePan===!1||Dn(p)}function Hn(p){switch(Pt(p),I.length){case 1:switch(t.touches.ONE){case de.ROTATE:if(t.enableRotate===!1)return;Dt(),i=a.TOUCH_ROTATE;break;case de.PAN:if(t.enablePan===!1)return;Gt(),i=a.TOUCH_PAN;break;default:i=a.NONE}break;case 2:switch(t.touches.TWO){case de.DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;Gn(),i=a.TOUCH_DOLLY_PAN;break;case de.DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;yn(),i=a.TOUCH_DOLLY_ROTATE;break;default:i=a.NONE}break;default:i=a.NONE}i!==a.NONE&&t.dispatchEvent(r)}function wn(p){switch(Pt(p),i){case a.TOUCH_ROTATE:if(t.enableRotate===!1)return;Rt(p),t.update();break;case a.TOUCH_PAN:if(t.enablePan===!1)return;bt(p),t.update();break;case a.TOUCH_DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;Rn(p),t.update();break;case a.TOUCH_DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;bn(p),t.update();break;default:i=a.NONE}}function wt(p){t.enabled!==!1&&p.preventDefault()}function Pn(p){I.push(p)}function On(p){delete Z[p.pointerId];for(let C=0;C<I.length;C++)if(I[C].pointerId==p.pointerId){I.splice(C,1);return}}function Pt(p){let C=Z[p.pointerId];C===void 0&&(C=new k,Z[p.pointerId]=C),C.set(p.pageX,p.pageY)}function nt(p){const C=p.pointerId===I[0].pointerId?I[1]:I[0];return Z[C.pointerId]}n!==void 0&&this.connect(n),this.update()}}function Te(u){if(typeof TextDecoder<"u")return new TextDecoder().decode(u);let e="";for(let n=0,t=u.length;n<t;n++)e+=String.fromCharCode(u[n]);try{return decodeURIComponent(escape(e))}catch{return e}}const Be="srgb",ne="srgb-linear",Kt=3001,Ls=3e3;class Pr extends Tt{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new Ss(n)}),this.register(function(n){return new xs(n)}),this.register(function(n){return new Qs(n)}),this.register(function(n){return new Ys(n)}),this.register(function(n){return new Zs(n)}),this.register(function(n){return new Us(n)}),this.register(function(n){return new Ks(n)}),this.register(function(n){return new ks(n)}),this.register(function(n){return new Ns(n)}),this.register(function(n){return new Os(n)}),this.register(function(n){return new _s(n)}),this.register(function(n){return new Js(n)}),this.register(function(n){return new js(n)}),this.register(function(n){return new Xs(n)}),this.register(function(n){return new ws(n)}),this.register(function(n){return new Vs(n)}),this.register(function(n){return new Ws(n)})}load(e,n,t,s){const r=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const l=Me.extractUrlBase(e);o=Me.resolveURL(l,this.path)}else o=Me.extractUrlBase(e);this.manager.itemStart(e);const a=function(l){s?s(l):console.error(l),r.manager.itemError(e),r.manager.itemEnd(e)},i=new Ke(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,function(l){try{r.parse(l,o,function(A){n(A),r.manager.itemEnd(e)},a)}catch(A){a(A)}},t,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,t,s){let r;const o={},a={};if(typeof e=="string")r=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Te(new Uint8Array(e.slice(0,4)))===mn){try{o[R.KHR_BINARY_GLTF]=new zs(e)}catch(A){s&&s(A);return}r=JSON.parse(o[R.KHR_BINARY_GLTF].content)}else r=JSON.parse(Te(new Uint8Array(e)));else r=e;if(r.asset===void 0||r.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const i=new Ar(r,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});i.fileLoader.setRequestHeader(this.requestHeader);for(let l=0;l<this.pluginCallbacks.length;l++){const A=this.pluginCallbacks[l](i);A.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[A.name]=A,o[A.name]=!0}if(r.extensionsUsed)for(let l=0;l<r.extensionsUsed.length;++l){const A=r.extensionsUsed[l],c=r.extensionsRequired||[];switch(A){case R.KHR_MATERIALS_UNLIT:o[A]=new Ps;break;case R.KHR_DRACO_MESH_COMPRESSION:o[A]=new qs(r,this.dracoLoader);break;case R.KHR_TEXTURE_TRANSFORM:o[A]=new $s;break;case R.KHR_MESH_QUANTIZATION:o[A]=new er;break;default:c.indexOf(A)>=0&&a[A]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+A+'".')}}i.setExtensions(o),i.setPlugins(a),i.parse(t,s)}parseAsync(e,n){const t=this;return new Promise(function(s,r){t.parse(e,n,s,r)})}}function Hs(){let u={};return{get:function(e){return u[e]},add:function(e,n){u[e]=n},remove:function(e){delete u[e]},removeAll:function(){u={}}}}const R={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ws{constructor(e){this.parser=e,this.name=R.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let t=0,s=n.length;t<s;t++){const r=n[t];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const n=this.parser,t="light:"+e;let s=n.cache.get(t);if(s)return s;const r=n.json,i=((r.extensions&&r.extensions[this.name]||{}).lights||[])[e];let l;const A=new U(16777215);i.color!==void 0&&A.setRGB(i.color[0],i.color[1],i.color[2],ne);const c=i.range!==void 0?i.range:0;switch(i.type){case"directional":l=new zt(A),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new pt(A),l.distance=c;break;case"spot":l=new Wt(A),l.distance=c,i.spot=i.spot||{},i.spot.innerConeAngle=i.spot.innerConeAngle!==void 0?i.spot.innerConeAngle:0,i.spot.outerConeAngle=i.spot.outerConeAngle!==void 0?i.spot.outerConeAngle:Math.PI/4,l.angle=i.spot.outerConeAngle,l.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return l.position.set(0,0,0),l.decay=2,te(l,i),i.intensity!==void 0&&(l.intensity=i.intensity),l.name=n.createUniqueName(i.name||"light_"+e),s=Promise.resolve(l),n.cache.add(t,s),s}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,t=this.parser,r=t.json.nodes[e],a=(r.extensions&&r.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(i){return t._getNodeRef(n.cache,a,i)})}}class Ps{constructor(){this.name=R.KHR_MATERIALS_UNLIT}getMaterialType(){return Pe}extendParams(e,n,t){const s=[];e.color=new U(1,1,1),e.opacity=1;const r=n.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const o=r.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],ne),e.opacity=o[3]}r.baseColorTexture!==void 0&&s.push(t.assignTexture(e,"map",r.baseColorTexture,Be))}return Promise.all(s)}}class Os{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name].emissiveStrength;return r!==void 0&&(n.emissiveIntensity=r),Promise.resolve()}}class Ss{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:V}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];if(o.clearcoatFactor!==void 0&&(n.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&r.push(t.assignTexture(n,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&r.push(t.assignTexture(n,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(r.push(t.assignTexture(n,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new k(a,a)}return Promise.all(r)}}class xs{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:V}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return n.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class Js{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:V}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.iridescenceFactor!==void 0&&(n.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&r.push(t.assignTexture(n,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(n.iridescenceIOR=o.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&r.push(t.assignTexture(n,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(r)}}class Us{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:V}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[];n.sheenColor=new U(0,0,0),n.sheenRoughness=0,n.sheen=1;const o=s.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;n.sheenColor.setRGB(a[0],a[1],a[2],ne)}return o.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&r.push(t.assignTexture(n,"sheenColorMap",o.sheenColorTexture,Be)),o.sheenRoughnessTexture!==void 0&&r.push(t.assignTexture(n,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(r)}}class Ks{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:V}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.transmissionFactor!==void 0&&(n.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&r.push(t.assignTexture(n,"transmissionMap",o.transmissionTexture)),Promise.all(r)}}class ks{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:V}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];n.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&r.push(t.assignTexture(n,"thicknessMap",o.thicknessTexture)),n.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return n.attenuationColor=new U().setRGB(a[0],a[1],a[2],ne),Promise.all(r)}}class Ns{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:V}extendMaterialParams(e,n){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return n.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class _s{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:V}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];n.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&r.push(t.assignTexture(n,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return n.specularColor=new U().setRGB(a[0],a[1],a[2],ne),o.specularColorTexture!==void 0&&r.push(t.assignTexture(n,"specularColorMap",o.specularColorTexture,Be)),Promise.all(r)}}class Xs{constructor(e){this.parser=e,this.name=R.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:V}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return n.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&r.push(t.assignTexture(n,"bumpMap",o.bumpTexture)),Promise.all(r)}}class js{constructor(e){this.parser=e,this.name=R.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:V}extendMaterialParams(e,n){const t=this.parser,s=t.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],o=s.extensions[this.name];return o.anisotropyStrength!==void 0&&(n.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(n.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&r.push(t.assignTexture(n,"anisotropyMap",o.anisotropyTexture)),Promise.all(r)}}class Qs{constructor(e){this.parser=e,this.name=R.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,t=n.json,s=t.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const r=s.extensions[this.name],o=n.options.ktx2Loader;if(!o){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,r.source,o)}}class Ys{constructor(e){this.parser=e,this.name=R.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,t=this.parser,s=t.json,r=s.textures[e];if(!r.extensions||!r.extensions[n])return null;const o=r.extensions[n],a=s.images[o.source];let i=t.textureLoader;if(a.uri){const l=t.options.manager.getHandler(a.uri);l!==null&&(i=l)}return this.detectSupport().then(function(l){if(l)return t.loadTextureImage(e,o.source,i);if(s.extensionsRequired&&s.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return t.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Zs{constructor(e){this.parser=e,this.name=R.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,t=this.parser,s=t.json,r=s.textures[e];if(!r.extensions||!r.extensions[n])return null;const o=r.extensions[n],a=s.images[o.source];let i=t.textureLoader;if(a.uri){const l=t.options.manager.getHandler(a.uri);l!==null&&(i=l)}return this.detectSupport().then(function(l){if(l)return t.loadTextureImage(e,o.source,i);if(s.extensionsRequired&&s.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return t.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Vs{constructor(e){this.name=R.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,t=n.bufferViews[e];if(t.extensions&&t.extensions[this.name]){const s=t.extensions[this.name],r=this.parser.getDependency("buffer",s.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(a){const i=s.byteOffset||0,l=s.byteLength||0,A=s.count,c=s.byteStride,h=new Uint8Array(a,i,l);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(A,c,h,s.mode,s.filter).then(function(B){return B.buffer}):o.ready.then(function(){const B=new ArrayBuffer(A*c);return o.decodeGltfBuffer(new Uint8Array(B),A,c,h,s.mode,s.filter),B})})}else return null}}class Ws{constructor(e){this.name=R.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,t=n.nodes[e];if(!t.extensions||!t.extensions[this.name]||t.mesh===void 0)return null;const s=n.meshes[t.mesh];for(const l of s.primitives)if(l.mode!==N.TRIANGLES&&l.mode!==N.TRIANGLE_STRIP&&l.mode!==N.TRIANGLE_FAN&&l.mode!==void 0)return null;const o=t.extensions[this.name].attributes,a=[],i={};for(const l in o)a.push(this.parser.getDependency("accessor",o[l]).then(A=>(i[l]=A,i[l])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(l=>{const A=l.pop(),c=A.isGroup?A.children:[A],h=l[0].count,B=[];for(const f of c){const d=new w,m=new P,g=new le,E=new P(1,1,1),F=new kn(f.geometry,f.material,h);for(let M=0;M<h;M++)i.TRANSLATION&&m.fromBufferAttribute(i.TRANSLATION,M),i.ROTATION&&g.fromBufferAttribute(i.ROTATION,M),i.SCALE&&E.fromBufferAttribute(i.SCALE,M),F.setMatrixAt(M,d.compose(m,g,E));for(const M in i)if(M==="_COLOR_0"){const b=i[M];F.instanceColor=new Nn(b.array,b.itemSize,b.normalized)}else M!=="TRANSLATION"&&M!=="ROTATION"&&M!=="SCALE"&&f.geometry.setAttribute(M,i[M]);Se.prototype.copy.call(F,f),this.parser.assignFinalMaterial(F),B.push(F)}return A.isGroup?(A.clear(),A.add(...B),A):B[0]}))}}const mn="glTF",we=12,kt={JSON:1313821514,BIN:5130562};class zs{constructor(e){this.name=R.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,we);if(this.header={magic:Te(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==mn)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const t=this.header.length-we,s=new DataView(e,we);let r=0;for(;r<t;){const o=s.getUint32(r,!0);r+=4;const a=s.getUint32(r,!0);if(r+=4,a===kt.JSON){const i=new Uint8Array(e,we+r,o);this.content=Te(i)}else if(a===kt.BIN){const i=we+r;this.body=e.slice(i,i+o)}r+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class qs{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=R.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const t=this.json,s=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},i={},l={};for(const A in o){const c=Mt[A]||A.toLowerCase();a[c]=o[A]}for(const A in e.attributes){const c=Mt[A]||A.toLowerCase();if(o[A]!==void 0){const h=t.accessors[e.attributes[A]],B=Ie[h.componentType];l[c]=B.name,i[c]=h.normalized===!0}}return n.getDependency("bufferView",r).then(function(A){return new Promise(function(c,h){s.decodeDracoFile(A,function(B){for(const f in B.attributes){const d=B.attributes[f],m=i[f];m!==void 0&&(d.normalized=m)}c(B)},a,l,ne,h)})})}}class $s{constructor(){this.name=R.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class er{constructor(){this.name=R.KHR_MESH_QUANTIZATION}}class Cn extends is{constructor(e,n,t,s){super(e,n,t,s)}copySampleValue_(e){const n=this.resultBuffer,t=this.sampleValues,s=this.valueSize,r=e*s*3+s;for(let o=0;o!==s;o++)n[o]=t[r+o];return n}interpolate_(e,n,t,s){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,i=a*2,l=a*3,A=s-n,c=(t-n)/A,h=c*c,B=h*c,f=e*l,d=f-l,m=-2*B+3*h,g=B-h,E=1-m,F=g-h+c;for(let M=0;M!==a;M++){const b=o[d+M+a],G=o[d+M+i]*A,H=o[f+M+a],v=o[f+M]*A;r[M]=E*b+F*G+m*H+g*v}return r}}const tr=new le;class nr extends Cn{interpolate_(e,n,t,s){const r=super.interpolate_(e,n,t,s);return tr.fromArray(r).normalize().toArray(r),r}}const N={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Ie={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Nt={9728:Wn,9729:$t,9984:zn,9985:qn,9986:$n,9987:en},_t={33071:dt,33648:es,10497:ke},at={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Mt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...An>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ce={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},sr={CUBICSPLINE:void 0,LINEAR:ln,STEP:ts},ct={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function rr(u){return u.DefaultMaterial===void 0&&(u.DefaultMaterial=new nn({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:ns})),u.DefaultMaterial}function he(u,e,n){for(const t in n.extensions)u[t]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[t]=n.extensions[t])}function te(u,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(u.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function or(u,e,n){let t=!1,s=!1,r=!1;for(let l=0,A=e.length;l<A;l++){const c=e[l];if(c.POSITION!==void 0&&(t=!0),c.NORMAL!==void 0&&(s=!0),c.COLOR_0!==void 0&&(r=!0),t&&s&&r)break}if(!t&&!s&&!r)return Promise.resolve(u);const o=[],a=[],i=[];for(let l=0,A=e.length;l<A;l++){const c=e[l];if(t){const h=c.POSITION!==void 0?n.getDependency("accessor",c.POSITION):u.attributes.position;o.push(h)}if(s){const h=c.NORMAL!==void 0?n.getDependency("accessor",c.NORMAL):u.attributes.normal;a.push(h)}if(r){const h=c.COLOR_0!==void 0?n.getDependency("accessor",c.COLOR_0):u.attributes.color;i.push(h)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(i)]).then(function(l){const A=l[0],c=l[1],h=l[2];return t&&(u.morphAttributes.position=A),s&&(u.morphAttributes.normal=c),r&&(u.morphAttributes.color=h),u.morphTargetsRelative=!0,u})}function ir(u,e){if(u.updateMorphTargets(),e.weights!==void 0)for(let n=0,t=e.weights.length;n<t;n++)u.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(u.morphTargetInfluences.length===n.length){u.morphTargetDictionary={};for(let t=0,s=n.length;t<s;t++)u.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ar(u){let e;const n=u.extensions&&u.extensions[R.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+lt(n.attributes):e=u.indices+":"+lt(u.attributes)+":"+u.mode,u.targets!==void 0)for(let t=0,s=u.targets.length;t<s;t++)e+=":"+lt(u.targets[t]);return e}function lt(u){let e="";const n=Object.keys(u).sort();for(let t=0,s=n.length;t<s;t++)e+=n[t]+":"+u[n[t]]+";";return e}function It(u){switch(u){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function cr(u){return u.search(/\.jpe?g($|\?)/i)>0||u.search(/^data\:image\/jpeg/)===0?"image/jpeg":u.search(/\.webp($|\?)/i)>0||u.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const lr=new w;class Ar{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new Hs,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let t=!1,s=!1,r=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,r=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||t||s&&r<98?this.textureLoader=new qt(this.options.manager):this.textureLoader=new _n(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ke(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const t=this,s=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([t.getDependencies("scene"),t.getDependencies("animation"),t.getDependencies("camera")])}).then(function(o){const a={scene:o[0][s.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:s.asset,parser:t,userData:{}};return he(r,a,s),te(a,s),Promise.all(t._invokeAll(function(i){return i.afterRoot&&i.afterRoot(a)})).then(function(){for(const i of a.scenes)i.updateMatrixWorld();e(a)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],t=this.json.meshes||[];for(let s=0,r=n.length;s<r;s++){const o=n[s].joints;for(let a=0,i=o.length;a<i;a++)e[o[a]].isBone=!0}for(let s=0,r=e.length;s<r;s++){const o=e[s];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(t[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,t){if(e.refs[n]<=1)return t;const s=t.clone(),r=(o,a)=>{const i=this.associations.get(o);i!=null&&this.associations.set(a,i);for(const[l,A]of o.children.entries())r(A,a.children[l])};return r(t,s),s.name+="_instance_"+e.uses[n]++,s}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let t=0;t<n.length;t++){const s=e(n[t]);if(s)return s}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const t=[];for(let s=0;s<n.length;s++){const r=e(n[s]);r&&t.push(r)}return t}getDependency(e,n){const t=e+":"+n;let s=this.cache.get(t);if(!s){switch(e){case"scene":s=this.loadScene(n);break;case"node":s=this._invokeOne(function(r){return r.loadNode&&r.loadNode(n)});break;case"mesh":s=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(n)});break;case"accessor":s=this.loadAccessor(n);break;case"bufferView":s=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(n)});break;case"buffer":s=this.loadBuffer(n);break;case"material":s=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(n)});break;case"texture":s=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(n)});break;case"skin":s=this.loadSkin(n);break;case"animation":s=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(n)});break;case"camera":s=this.loadCamera(n);break;default:if(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,n)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(t,s)}return s}getDependencies(e){let n=this.cache.get(e);if(!n){const t=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(s.map(function(r,o){return t.getDependency(e,o)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],t=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[R.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(r,o){t.load(Me.resolveURL(n.uri,s.path),r,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(t){const s=n.byteLength||0,r=n.byteOffset||0;return t.slice(r,r+s)})}loadAccessor(e){const n=this,t=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const o=at[s.type],a=Ie[s.componentType],i=s.normalized===!0,l=new a(s.count*o);return Promise.resolve(new xe(l,o,i))}const r=[];return s.bufferView!==void 0?r.push(this.getDependency("bufferView",s.bufferView)):r.push(null),s.sparse!==void 0&&(r.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(r).then(function(o){const a=o[0],i=at[s.type],l=Ie[s.componentType],A=l.BYTES_PER_ELEMENT,c=A*i,h=s.byteOffset||0,B=s.bufferView!==void 0?t.bufferViews[s.bufferView].byteStride:void 0,f=s.normalized===!0;let d,m;if(B&&B!==c){const g=Math.floor(h/B),E="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+g+":"+s.count;let F=n.cache.get(E);F||(d=new l(a,g*B,s.count*B/A),F=new Xn(d,B/A),n.cache.add(E,F)),m=new ss(F,i,h%B/A,f)}else a===null?d=new l(s.count*i):d=new l(a,h,s.count*i),m=new xe(d,i,f);if(s.sparse!==void 0){const g=at.SCALAR,E=Ie[s.sparse.indices.componentType],F=s.sparse.indices.byteOffset||0,M=s.sparse.values.byteOffset||0,b=new E(o[1],F,s.sparse.count*g),G=new l(o[2],M,s.sparse.count*i);a!==null&&(m=new xe(m.array.slice(),m.itemSize,m.normalized));for(let H=0,v=b.length;H<v;H++){const S=b[H];if(m.setX(S,G[H*i]),i>=2&&m.setY(S,G[H*i+1]),i>=3&&m.setZ(S,G[H*i+2]),i>=4&&m.setW(S,G[H*i+3]),i>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m})}loadTexture(e){const n=this.json,t=this.options,r=n.textures[e].source,o=n.images[r];let a=this.textureLoader;if(o.uri){const i=t.manager.getHandler(o.uri);i!==null&&(a=i)}return this.loadTextureImage(e,r,a)}loadTextureImage(e,n,t){const s=this,r=this.json,o=r.textures[e],a=r.images[n],i=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[i])return this.textureCache[i];const l=this.loadImageSource(n,t).then(function(A){A.flipY=!1,A.name=o.name||a.name||"",A.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(A.name=a.uri);const h=(r.samplers||{})[o.sampler]||{};return A.magFilter=Nt[h.magFilter]||$t,A.minFilter=Nt[h.minFilter]||en,A.wrapS=_t[h.wrapS]||ke,A.wrapT=_t[h.wrapT]||ke,s.associations.set(A,{textures:e}),A}).catch(function(){return null});return this.textureCache[i]=l,l}loadImageSource(e,n){const t=this,s=this.json,r=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(c=>c.clone());const o=s.images[e],a=self.URL||self.webkitURL;let i=o.uri||"",l=!1;if(o.bufferView!==void 0)i=t.getDependency("bufferView",o.bufferView).then(function(c){l=!0;const h=new Blob([c],{type:o.mimeType});return i=a.createObjectURL(h),i});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const A=Promise.resolve(i).then(function(c){return new Promise(function(h,B){let f=h;n.isImageBitmapLoader===!0&&(f=function(d){const m=new qe(d);m.needsUpdate=!0,h(m)}),n.load(Me.resolveURL(c,r.path),f,void 0,B)})}).then(function(c){return l===!0&&a.revokeObjectURL(i),te(c,o),c.userData.mimeType=o.mimeType||cr(o.uri),c}).catch(function(c){throw console.error("THREE.GLTFLoader: Couldn't load texture",i),c});return this.sourceCache[e]=A,A}assignTexture(e,n,t,s){const r=this;return this.getDependency("texture",t.index).then(function(o){if(!o)return null;if(t.texCoord!==void 0&&t.texCoord>0&&(o=o.clone(),o.channel=t.texCoord),r.extensions[R.KHR_TEXTURE_TRANSFORM]){const a=t.extensions!==void 0?t.extensions[R.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const i=r.associations.get(o);o=r.extensions[R.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),r.associations.set(o,i)}}return s!==void 0&&(typeof s=="number"&&(s=s===Kt?Be:ne),"colorSpace"in o?o.colorSpace=s:o.encoding=s===Be?Kt:Ls),e[n]=o,o})}assignFinalMaterial(e){const n=e.geometry;let t=e.material;const s=n.attributes.tangent===void 0,r=n.attributes.color!==void 0,o=n.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+t.uuid;let i=this.cache.get(a);i||(i=new jn,st.prototype.copy.call(i,t),i.color.copy(t.color),i.map=t.map,i.sizeAttenuation=!1,this.cache.add(a,i)),t=i}else if(e.isLine){const a="LineBasicMaterial:"+t.uuid;let i=this.cache.get(a);i||(i=new tn,st.prototype.copy.call(i,t),i.color.copy(t.color),i.map=t.map,this.cache.add(a,i)),t=i}if(s||r||o){let a="ClonedMaterial:"+t.uuid+":";s&&(a+="derivative-tangents:"),r&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let i=this.cache.get(a);i||(i=t.clone(),r&&(i.vertexColors=!0),o&&(i.flatShading=!0),s&&(i.normalScale&&(i.normalScale.y*=-1),i.clearcoatNormalScale&&(i.clearcoatNormalScale.y*=-1)),this.cache.add(a,i),this.associations.set(i,this.associations.get(t))),t=i}e.material=t}getMaterialType(){return nn}loadMaterial(e){const n=this,t=this.json,s=this.extensions,r=t.materials[e];let o;const a={},i=r.extensions||{},l=[];if(i[R.KHR_MATERIALS_UNLIT]){const c=s[R.KHR_MATERIALS_UNLIT];o=c.getMaterialType(),l.push(c.extendParams(a,r,n))}else{const c=r.pbrMetallicRoughness||{};if(a.color=new U(1,1,1),a.opacity=1,Array.isArray(c.baseColorFactor)){const h=c.baseColorFactor;a.color.setRGB(h[0],h[1],h[2],ne),a.opacity=h[3]}c.baseColorTexture!==void 0&&l.push(n.assignTexture(a,"map",c.baseColorTexture,Be)),a.metalness=c.metallicFactor!==void 0?c.metallicFactor:1,a.roughness=c.roughnessFactor!==void 0?c.roughnessFactor:1,c.metallicRoughnessTexture!==void 0&&(l.push(n.assignTexture(a,"metalnessMap",c.metallicRoughnessTexture)),l.push(n.assignTexture(a,"roughnessMap",c.metallicRoughnessTexture))),o=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}r.doubleSided===!0&&(a.side=Qn);const A=r.alphaMode||ct.OPAQUE;if(A===ct.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,A===ct.MASK&&(a.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&o!==Pe&&(l.push(n.assignTexture(a,"normalMap",r.normalTexture)),a.normalScale=new k(1,1),r.normalTexture.scale!==void 0)){const c=r.normalTexture.scale;a.normalScale.set(c,c)}if(r.occlusionTexture!==void 0&&o!==Pe&&(l.push(n.assignTexture(a,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&o!==Pe){const c=r.emissiveFactor;a.emissive=new U().setRGB(c[0],c[1],c[2],ne)}return r.emissiveTexture!==void 0&&o!==Pe&&l.push(n.assignTexture(a,"emissiveMap",r.emissiveTexture,Be)),Promise.all(l).then(function(){const c=new o(a);return r.name&&(c.name=r.name),te(c,r),n.associations.set(c,{materials:e}),r.extensions&&he(s,c,r),c})}createUniqueName(e){const n=Ne.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,t=this.extensions,s=this.primitiveCache;function r(a){return t[R.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,n).then(function(i){return Xt(i,a,n)})}const o=[];for(let a=0,i=e.length;a<i;a++){const l=e[a],A=ar(l),c=s[A];if(c)o.push(c.promise);else{let h;l.extensions&&l.extensions[R.KHR_DRACO_MESH_COMPRESSION]?h=r(l):h=Xt(new Fe,l,n),s[A]={primitive:l,promise:h},o.push(h)}}return Promise.all(o)}loadMesh(e){const n=this,t=this.json,s=this.extensions,r=t.meshes[e],o=r.primitives,a=[];for(let i=0,l=o.length;i<l;i++){const A=o[i].material===void 0?rr(this.cache):this.getDependency("material",o[i].material);a.push(A)}return a.push(n.loadGeometries(o)),Promise.all(a).then(function(i){const l=i.slice(0,i.length-1),A=i[i.length-1],c=[];for(let B=0,f=A.length;B<f;B++){const d=A[B],m=o[B];let g;const E=l[B];if(m.mode===N.TRIANGLES||m.mode===N.TRIANGLE_STRIP||m.mode===N.TRIANGLE_FAN||m.mode===void 0)g=r.isSkinnedMesh===!0?new sn(d,E):new rn(d,E),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),m.mode===N.TRIANGLE_STRIP?g.geometry=xt(g.geometry,Vt):m.mode===N.TRIANGLE_FAN&&(g.geometry=xt(g.geometry,Bt));else if(m.mode===N.LINES)g=new Yn(d,E);else if(m.mode===N.LINE_STRIP)g=new on(d,E);else if(m.mode===N.LINE_LOOP)g=new Zn(d,E);else if(m.mode===N.POINTS)g=new Vn(d,E);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(g.geometry.morphAttributes).length>0&&ir(g,r),g.name=n.createUniqueName(r.name||"mesh_"+e),te(g,r),m.extensions&&he(s,g,m),n.assignFinalMaterial(g),c.push(g)}for(let B=0,f=c.length;B<f;B++)n.associations.set(c[B],{meshes:e,primitives:B});if(c.length===1)return r.extensions&&he(s,c[0],r),c[0];const h=new Je;r.extensions&&he(s,h,r),n.associations.set(h,{meshes:e});for(let B=0,f=c.length;B<f;B++)h.add(c[B]);return h})}loadCamera(e){let n;const t=this.json.cameras[e],s=t[t.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return t.type==="perspective"?n=new ge(Y.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):t.type==="orthographic"&&(n=new Ee(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),t.name&&(n.name=this.createUniqueName(t.name)),te(n,t),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],t=[];for(let s=0,r=n.joints.length;s<r;s++)t.push(this._loadNodeShallow(n.joints[s]));return n.inverseBindMatrices!==void 0?t.push(this.getDependency("accessor",n.inverseBindMatrices)):t.push(null),Promise.all(t).then(function(s){const r=s.pop(),o=s,a=[],i=[];for(let l=0,A=o.length;l<A;l++){const c=o[l];if(c){a.push(c);const h=new w;r!==null&&h.fromArray(r.array,l*16),i.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[l])}return new an(a,i)})}loadAnimation(e){const n=this.json,t=this,s=n.animations[e],r=s.name?s.name:"animation_"+e,o=[],a=[],i=[],l=[],A=[];for(let c=0,h=s.channels.length;c<h;c++){const B=s.channels[c],f=s.samplers[B.sampler],d=B.target,m=d.node,g=s.parameters!==void 0?s.parameters[f.input]:f.input,E=s.parameters!==void 0?s.parameters[f.output]:f.output;d.node!==void 0&&(o.push(this.getDependency("node",m)),a.push(this.getDependency("accessor",g)),i.push(this.getDependency("accessor",E)),l.push(f),A.push(d))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(i),Promise.all(l),Promise.all(A)]).then(function(c){const h=c[0],B=c[1],f=c[2],d=c[3],m=c[4],g=[];for(let E=0,F=h.length;E<F;E++){const M=h[E],b=B[E],G=f[E],H=d[E],v=m[E];if(M===void 0)continue;M.updateMatrix&&M.updateMatrix();const S=t._createAnimationTracks(M,b,G,H,v);if(S)for(let I=0;I<S.length;I++)g.push(S[I])}return new cn(r,void 0,g)})}createNodeMesh(e){const n=this.json,t=this,s=n.nodes[e];return s.mesh===void 0?null:t.getDependency("mesh",s.mesh).then(function(r){const o=t._getNodeRef(t.meshCache,s.mesh,r);return s.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let i=0,l=s.weights.length;i<l;i++)a.morphTargetInfluences[i]=s.weights[i]}),o})}loadNode(e){const n=this.json,t=this,s=n.nodes[e],r=t._loadNodeShallow(e),o=[],a=s.children||[];for(let l=0,A=a.length;l<A;l++)o.push(t.getDependency("node",a[l]));const i=s.skin===void 0?Promise.resolve(null):t.getDependency("skin",s.skin);return Promise.all([r,Promise.all(o),i]).then(function(l){const A=l[0],c=l[1],h=l[2];h!==null&&A.traverse(function(B){B.isSkinnedMesh&&B.bind(h,lr)});for(let B=0,f=c.length;B<f;B++)A.add(c[B]);return A})}_loadNodeShallow(e){const n=this.json,t=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const r=n.nodes[e],o=r.name?s.createUniqueName(r.name):"",a=[],i=s._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return i&&a.push(i),r.camera!==void 0&&a.push(s.getDependency("camera",r.camera).then(function(l){return s._getNodeRef(s.cameraCache,r.camera,l)})),s._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){a.push(l)}),this.nodeCache[e]=Promise.all(a).then(function(l){let A;if(r.isBone===!0?A=new ft:l.length>1?A=new Je:l.length===1?A=l[0]:A=new Se,A!==l[0])for(let c=0,h=l.length;c<h;c++)A.add(l[c]);if(r.name&&(A.userData.name=r.name,A.name=o),te(A,r),r.extensions&&he(t,A,r),r.matrix!==void 0){const c=new w;c.fromArray(r.matrix),A.applyMatrix4(c)}else r.translation!==void 0&&A.position.fromArray(r.translation),r.rotation!==void 0&&A.quaternion.fromArray(r.rotation),r.scale!==void 0&&A.scale.fromArray(r.scale);return s.associations.has(A)||s.associations.set(A,{}),s.associations.get(A).nodes=e,A}),this.nodeCache[e]}loadScene(e){const n=this.extensions,t=this.json.scenes[e],s=this,r=new Je;t.name&&(r.name=s.createUniqueName(t.name)),te(r,t),t.extensions&&he(n,r,t);const o=t.nodes||[],a=[];for(let i=0,l=o.length;i<l;i++)a.push(s.getDependency("node",o[i]));return Promise.all(a).then(function(i){for(let A=0,c=i.length;A<c;A++)r.add(i[A]);const l=A=>{const c=new Map;for(const[h,B]of s.associations)(h instanceof st||h instanceof qe)&&c.set(h,B);return A.traverse(h=>{const B=s.associations.get(h);B!=null&&c.set(h,B)}),c};return s.associations=l(r),r})}_createAnimationTracks(e,n,t,s,r){const o=[],a=e.name?e.name:e.uuid,i=[];ce[r.path]===ce.weights?e.traverse(function(h){h.morphTargetInfluences&&i.push(h.name?h.name:h.uuid)}):i.push(a);let l;switch(ce[r.path]){case ce.weights:l=Ct;break;case ce.rotation:l=gt;break;case ce.position:case ce.scale:l=mt;break;default:switch(t.itemSize){case 1:l=Ct;break;case 2:case 3:default:l=mt;break}break}const A=s.interpolation!==void 0?sr[s.interpolation]:ln,c=this._getArrayFromAccessor(t);for(let h=0,B=i.length;h<B;h++){const f=new l(i[h]+"."+ce[r.path],n.array,c,A);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(f),o.push(f)}return o}_getArrayFromAccessor(e){let n=e.array;if(e.normalized){const t=It(n.constructor),s=new Float32Array(n.length);for(let r=0,o=n.length;r<o;r++)s[r]=n[r]*t;n=s}return n}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(t){const s=this instanceof gt?nr:Cn;return new s(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function ur(u,e,n){const t=e.attributes,s=new rs;if(t.POSITION!==void 0){const a=n.json.accessors[t.POSITION],i=a.min,l=a.max;if(i!==void 0&&l!==void 0){if(s.set(new P(i[0],i[1],i[2]),new P(l[0],l[1],l[2])),a.normalized){const A=It(Ie[a.componentType]);s.min.multiplyScalar(A),s.max.multiplyScalar(A)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=e.targets;if(r!==void 0){const a=new P,i=new P;for(let l=0,A=r.length;l<A;l++){const c=r[l];if(c.POSITION!==void 0){const h=n.json.accessors[c.POSITION],B=h.min,f=h.max;if(B!==void 0&&f!==void 0){if(i.setX(Math.max(Math.abs(B[0]),Math.abs(f[0]))),i.setY(Math.max(Math.abs(B[1]),Math.abs(f[1]))),i.setZ(Math.max(Math.abs(B[2]),Math.abs(f[2]))),h.normalized){const d=It(Ie[h.componentType]);i.multiplyScalar(d)}a.max(i)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(a)}u.boundingBox=s;const o=new os;s.getCenter(o.center),o.radius=s.min.distanceTo(s.max)/2,u.boundingSphere=o}function Xt(u,e,n){const t=e.attributes,s=[];function r(o,a){return n.getDependency("accessor",o).then(function(i){u.setAttribute(a,i)})}for(const o in t){const a=Mt[o]||o.toLowerCase();a in u.attributes||s.push(r(t[o],a))}if(e.indices!==void 0&&!u.index){const o=n.getDependency("accessor",e.indices).then(function(a){u.setIndex(a)});s.push(o)}return te(u,e),ur(u,e,n),Promise.all(s).then(function(){return e.targets!==void 0?or(u,e.targets,n):u})}function gn(u,e,n){const t=n.length-u-1;if(e>=n[t])return t-1;if(e<=n[u])return u;let s=u,r=t,o=Math.floor((s+r)/2);for(;e<n[o]||e>=n[o+1];)e<n[o]?r=o:s=o,o=Math.floor((s+r)/2);return o}function hr(u,e,n,t){const s=[],r=[],o=[];s[0]=1;for(let a=1;a<=n;++a){r[a]=e-t[u+1-a],o[a]=t[u+a]-e;let i=0;for(let l=0;l<a;++l){const A=o[l+1],c=r[a-l],h=s[l]/(A+c);s[l]=i+A*h,i=c*h}s[a]=i}return s}function Br(u,e,n,t){const s=gn(u,t,e),r=hr(s,t,u,e),o=new $e(0,0,0,0);for(let a=0;a<=u;++a){const i=n[s-u+a],l=r[a],A=i.w*l;o.x+=i.x*A,o.y+=i.y*A,o.z+=i.z*A,o.w+=i.w*l}return o}function pr(u,e,n,t,s){const r=[];for(let c=0;c<=n;++c)r[c]=0;const o=[];for(let c=0;c<=t;++c)o[c]=r.slice(0);const a=[];for(let c=0;c<=n;++c)a[c]=r.slice(0);a[0][0]=1;const i=r.slice(0),l=r.slice(0);for(let c=1;c<=n;++c){i[c]=e-s[u+1-c],l[c]=s[u+c]-e;let h=0;for(let B=0;B<c;++B){const f=l[B+1],d=i[c-B];a[c][B]=f+d;const m=a[B][c-1]/a[c][B];a[B][c]=h+f*m,h=d*m}a[c][c]=h}for(let c=0;c<=n;++c)o[0][c]=a[c][n];for(let c=0;c<=n;++c){let h=0,B=1;const f=[];for(let d=0;d<=n;++d)f[d]=r.slice(0);f[0][0]=1;for(let d=1;d<=t;++d){let m=0;const g=c-d,E=n-d;c>=d&&(f[B][0]=f[h][0]/a[E+1][g],m=f[B][0]*a[g][E]);const F=g>=-1?1:-g,M=c-1<=E?d-1:n-c;for(let G=F;G<=M;++G)f[B][G]=(f[h][G]-f[h][G-1])/a[E+1][g+G],m+=f[B][G]*a[g+G][E];c<=E&&(f[B][d]=-f[h][d-1]/a[E+1][c],m+=f[B][d]*a[c][E]),o[d][c]=m;const b=h;h=B,B=b}}let A=n;for(let c=1;c<=t;++c){for(let h=0;h<=n;++h)o[c][h]*=A;A*=n-c}return o}function fr(u,e,n,t,s){const r=s<u?s:u,o=[],a=gn(u,t,e),i=pr(a,t,u,r,e),l=[];for(let A=0;A<n.length;++A){const c=n[A].clone(),h=c.w;c.x*=h,c.y*=h,c.z*=h,l[A]=c}for(let A=0;A<=r;++A){const c=l[a-u].clone().multiplyScalar(i[A][0]);for(let h=1;h<=u;++h)c.add(l[a-u+h].clone().multiplyScalar(i[A][h]));o[A]=c}for(let A=r+1;A<=s+1;++A)o[A]=new $e(0,0,0);return o}function dr(u,e){let n=1;for(let s=2;s<=u;++s)n*=s;let t=1;for(let s=2;s<=e;++s)t*=s;for(let s=2;s<=u-e;++s)t*=s;return n/t}function mr(u){const e=u.length,n=[],t=[];for(let r=0;r<e;++r){const o=u[r];n[r]=new P(o.x,o.y,o.z),t[r]=o.w}const s=[];for(let r=0;r<e;++r){const o=n[r].clone();for(let a=1;a<=r;++a)o.sub(s[r-a].clone().multiplyScalar(dr(r,a)*t[a]));s[r]=o.divideScalar(t[0])}return s}function Cr(u,e,n,t,s){const r=fr(u,e,n,t,s);return mr(r)}class jt extends as{constructor(e,n,t,s,r){super(),this.degree=e,this.knots=n,this.controlPoints=[],this.startKnot=s||0,this.endKnot=r||this.knots.length-1;for(let o=0;o<t.length;++o){const a=t[o];this.controlPoints[o]=new $e(a.x,a.y,a.z,a.w)}}getPoint(e,n){const t=n||new P,s=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),r=Br(this.degree,this.knots,this.controlPoints,s);return r.w!=1&&r.divideScalar(r.w),t.set(r.x,r.y,r.z)}getTangent(e,n){const t=n||new P,s=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),r=Cr(this.degree,this.knots,this.controlPoints,s,1);return t.copy(r[1]).normalize(),t}}let y,x,K;class Or extends Tt{constructor(e){super(e)}load(e,n,t,s){const r=this,o=r.path===""?Me.extractUrlBase(e):r.path,a=new Ke(this.manager);a.setPath(r.path),a.setResponseType("arraybuffer"),a.setRequestHeader(r.requestHeader),a.setWithCredentials(r.withCredentials),a.load(e,function(i){try{n(r.parse(i,o))}catch(l){s?s(l):console.error(l),r.manager.itemError(e)}},t,s)}parse(e,n){if(Tr(e))y=new Ir().parse(e);else{const s=In(e);if(!Dr(s))throw new Error("THREE.FBXLoader: Unknown format.");if(Yt(s)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+Yt(s));y=new Mr().parse(s)}const t=new qt(this.manager).setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);return new gr(t,this.manager).parse(y)}}class gr{constructor(e,n){this.textureLoader=e,this.manager=n}parse(){x=this.parseConnections();const e=this.parseImages(),n=this.parseTextures(e),t=this.parseMaterials(n),s=this.parseDeformers(),r=new Er().parse(s);return this.parseScene(s,r,t),K}parseConnections(){const e=new Map;return"Connections"in y&&y.Connections.connections.forEach(function(t){const s=t[0],r=t[1],o=t[2];e.has(s)||e.set(s,{parents:[],children:[]});const a={ID:r,relationship:o};e.get(s).parents.push(a),e.has(r)||e.set(r,{parents:[],children:[]});const i={ID:s,relationship:o};e.get(r).children.push(i)}),e}parseImages(){const e={},n={};if("Video"in y.Objects){const t=y.Objects.Video;for(const s in t){const r=t[s],o=parseInt(s);if(e[o]=r.RelativeFilename||r.Filename,"Content"in r){const a=r.Content instanceof ArrayBuffer&&r.Content.byteLength>0,i=typeof r.Content=="string"&&r.Content!=="";if(a||i){const l=this.parseImage(t[s]);n[r.RelativeFilename||r.Filename]=l}}}}for(const t in e){const s=e[t];n[s]!==void 0?e[t]=n[s]:e[t]=e[t].split("\\").pop()}return e}parseImage(e){const n=e.Content,t=e.RelativeFilename||e.Filename,s=t.slice(t.lastIndexOf(".")+1).toLowerCase();let r;switch(s){case"bmp":r="image/bmp";break;case"jpg":case"jpeg":r="image/jpeg";break;case"png":r="image/png";break;case"tif":r="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",t),r="image/tga";break;default:console.warn('FBXLoader: Image type "'+s+'" is not supported.');return}if(typeof n=="string")return"data:"+r+";base64,"+n;{const o=new Uint8Array(n);return window.URL.createObjectURL(new Blob([o],{type:r}))}}parseTextures(e){const n=new Map;if("Texture"in y.Objects){const t=y.Objects.Texture;for(const s in t){const r=this.parseTexture(t[s],e);n.set(parseInt(s),r)}}return n}parseTexture(e,n){const t=this.loadTexture(e,n);t.ID=e.id,t.name=e.attrName;const s=e.WrapModeU,r=e.WrapModeV,o=s!==void 0?s.value:0,a=r!==void 0?r.value:0;if(t.wrapS=o===0?ke:dt,t.wrapT=a===0?ke:dt,"Scaling"in e){const i=e.Scaling.value;t.repeat.x=i[0],t.repeat.y=i[1]}return t}loadTexture(e,n){let t;const s=this.textureLoader.path,r=x.get(e.id).children;r!==void 0&&r.length>0&&n[r[0].ID]!==void 0&&(t=n[r[0].ID],(t.indexOf("blob:")===0||t.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let o;const a=e.FileName.slice(-3).toLowerCase();if(a==="tga"){const i=this.manager.getHandler(".tga");i===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),o=new qe):(i.setPath(this.textureLoader.path),o=i.load(t))}else a==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),o=new qe):o=this.textureLoader.load(t);return this.textureLoader.setPath(s),o}parseMaterials(e){const n=new Map;if("Material"in y.Objects){const t=y.Objects.Material;for(const s in t){const r=this.parseMaterial(t[s],e);r!==null&&n.set(parseInt(s),r)}}return n}parseMaterial(e,n){const t=e.id,s=e.attrName;let r=e.ShadingModel;if(typeof r=="object"&&(r=r.value),!x.has(t))return null;const o=this.parseParameters(e,n,t);let a;switch(r.toLowerCase()){case"phong":a=new rt;break;case"lambert":a=new cs;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',r),a=new rt;break}return a.setValues(o),a.name=s,a}parseParameters(e,n,t){const s={};e.BumpFactor&&(s.bumpScale=e.BumpFactor.value),e.Diffuse?s.color=new U().fromArray(e.Diffuse.value):e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(s.color=new U().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(s.displacementScale=e.DisplacementFactor.value),e.Emissive?s.emissive=new U().fromArray(e.Emissive.value):e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(s.emissive=new U().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(s.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(s.opacity=parseFloat(e.Opacity.value)),s.opacity<1&&(s.transparent=!0),e.ReflectionFactor&&(s.reflectivity=e.ReflectionFactor.value),e.Shininess&&(s.shininess=e.Shininess.value),e.Specular?s.specular=new U().fromArray(e.Specular.value):e.SpecularColor&&e.SpecularColor.type==="Color"&&(s.specular=new U().fromArray(e.SpecularColor.value));const r=this;return x.get(t).children.forEach(function(o){const a=o.relationship;switch(a){case"Bump":s.bumpMap=r.getTexture(n,o.ID);break;case"Maya|TEX_ao_map":s.aoMap=r.getTexture(n,o.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":s.map=r.getTexture(n,o.ID),s.map!==void 0&&("colorSpace"in s.map?s.map.colorSpace="srgb":s.map.encoding=3001);break;case"DisplacementColor":s.displacementMap=r.getTexture(n,o.ID);break;case"EmissiveColor":s.emissiveMap=r.getTexture(n,o.ID),s.emissiveMap!==void 0&&("colorSpace"in s.emissiveMap?s.emissiveMap.colorSpace="srgb":s.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":s.normalMap=r.getTexture(n,o.ID);break;case"ReflectionColor":s.envMap=r.getTexture(n,o.ID),s.envMap!==void 0&&(s.envMap.mapping=ls,"colorSpace"in s.envMap?s.envMap.colorSpace="srgb":s.envMap.encoding=3001);break;case"SpecularColor":s.specularMap=r.getTexture(n,o.ID),s.specularMap!==void 0&&("colorSpace"in s.specularMap?s.specularMap.colorSpace="srgb":s.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":s.alphaMap=r.getTexture(n,o.ID),s.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a);break}}),s}getTexture(e,n){return"LayeredTexture"in y.Objects&&n in y.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=x.get(n).children[0].ID),e.get(n)}parseDeformers(){const e={},n={};if("Deformer"in y.Objects){const t=y.Objects.Deformer;for(const s in t){const r=t[s],o=x.get(parseInt(s));if(r.attrType==="Skin"){const a=this.parseSkeleton(o,t);a.ID=s,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=o.parents[0].ID,e[s]=a}else if(r.attrType==="BlendShape"){const a={id:s};a.rawTargets=this.parseMorphTargets(o,t),a.id=s,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),n[s]=a}}}return{skeletons:e,morphTargets:n}}parseSkeleton(e,n){const t=[];return e.children.forEach(function(s){const r=n[s.ID];if(r.attrType!=="Cluster")return;const o={ID:s.ID,indices:[],weights:[],transformLink:new w().fromArray(r.TransformLink.a)};"Indexes"in r&&(o.indices=r.Indexes.a,o.weights=r.Weights.a),t.push(o)}),{rawBones:t,bones:[]}}parseMorphTargets(e,n){const t=[];for(let s=0;s<e.children.length;s++){const r=e.children[s],o=n[r.ID],a={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if(o.attrType!=="BlendShapeChannel")return;a.geoID=x.get(parseInt(r.ID)).children.filter(function(i){return i.relationship===void 0})[0].ID,t.push(a)}return t}parseScene(e,n,t){K=new Je;const s=this.parseModels(e.skeletons,n,t),r=y.Objects.Model,o=this;s.forEach(function(i){const l=r[i.ID];o.setLookAtProperties(i,l),x.get(i.ID).parents.forEach(function(c){const h=s.get(c.ID);h!==void 0&&h.add(i)}),i.parent===null&&K.add(i)}),this.bindSkeleton(e.skeletons,n,s),this.createAmbientLight(),K.traverse(function(i){if(i.userData.transformData){i.parent&&(i.userData.transformData.parentMatrix=i.parent.matrix,i.userData.transformData.parentMatrixWorld=i.parent.matrixWorld);const l=Fn(i.userData.transformData);i.applyMatrix4(l),i.updateWorldMatrix()}});const a=new Fr().parse();K.children.length===1&&K.children[0].isGroup&&(K.children[0].animations=a,K=K.children[0]),K.animations=a}parseModels(e,n,t){const s=new Map,r=y.Objects.Model;for(const o in r){const a=parseInt(o),i=r[o],l=x.get(a);let A=this.buildSkeleton(l,e,a,i.attrName);if(!A){switch(i.attrType){case"Camera":A=this.createCamera(l);break;case"Light":A=this.createLight(l);break;case"Mesh":A=this.createMesh(l,n,t);break;case"NurbsCurve":A=this.createCurve(l,n);break;case"LimbNode":case"Root":A=new ft;break;case"Null":default:A=new Je;break}A.name=i.attrName?Ne.sanitizeNodeName(i.attrName):"",A.ID=a}this.getTransformData(A,i),s.set(a,A)}return s}buildSkeleton(e,n,t,s){let r=null;return e.parents.forEach(function(o){for(const a in n){const i=n[a];i.rawBones.forEach(function(l,A){if(l.ID===o.ID){const c=r;r=new ft,r.matrixWorld.copy(l.transformLink),r.name=s?Ne.sanitizeNodeName(s):"",r.ID=t,i.bones[A]=r,c!==null&&r.add(c)}})}}),r}createCamera(e){let n,t;if(e.children.forEach(function(s){const r=y.Objects.NodeAttribute[s.ID];r!==void 0&&(t=r)}),t===void 0)n=new Se;else{let s=0;t.CameraProjectionType!==void 0&&t.CameraProjectionType.value===1&&(s=1);let r=1;t.NearPlane!==void 0&&(r=t.NearPlane.value/1e3);let o=1e3;t.FarPlane!==void 0&&(o=t.FarPlane.value/1e3);let a=window.innerWidth,i=window.innerHeight;t.AspectWidth!==void 0&&t.AspectHeight!==void 0&&(a=t.AspectWidth.value,i=t.AspectHeight.value);const l=a/i;let A=45;t.FieldOfView!==void 0&&(A=t.FieldOfView.value);const c=t.FocalLength?t.FocalLength.value:null;switch(s){case 0:n=new ge(A,l,r,o),c!==null&&n.setFocalLength(c);break;case 1:n=new Ee(-a/2,a/2,i/2,-i/2,r,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+s+"."),n=new Se;break}}return n}createLight(e){let n,t;if(e.children.forEach(function(s){const r=y.Objects.NodeAttribute[s.ID];r!==void 0&&(t=r)}),t===void 0)n=new Se;else{let s;t.LightType===void 0?s=0:s=t.LightType.value;let r=16777215;t.Color!==void 0&&(r=new U().fromArray(t.Color.value));let o=t.Intensity===void 0?1:t.Intensity.value/100;t.CastLightOnObject!==void 0&&t.CastLightOnObject.value===0&&(o=0);let a=0;t.FarAttenuationEnd!==void 0&&(t.EnableFarAttenuation!==void 0&&t.EnableFarAttenuation.value===0?a=0:a=t.FarAttenuationEnd.value);const i=1;switch(s){case 0:n=new pt(r,o,a,i);break;case 1:n=new zt(r,o);break;case 2:let l=Math.PI/3;t.InnerAngle!==void 0&&(l=Y.degToRad(t.InnerAngle.value));let A=0;t.OuterAngle!==void 0&&(A=Y.degToRad(t.OuterAngle.value),A=Math.max(A,1)),n=new Wt(r,o,a,l,A,i);break;default:console.warn("THREE.FBXLoader: Unknown light type "+t.LightType.value+", defaulting to a PointLight."),n=new pt(r,o);break}t.CastShadows!==void 0&&t.CastShadows.value===1&&(n.castShadow=!0)}return n}createMesh(e,n,t){let s,r=null,o=null;const a=[];return e.children.forEach(function(i){n.has(i.ID)&&(r=n.get(i.ID)),t.has(i.ID)&&a.push(t.get(i.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new rt({color:13421772}),a.push(o)),"color"in r.attributes&&a.forEach(function(i){i.vertexColors=!0}),r.FBX_Deformer?(s=new sn(r,o),s.normalizeSkinWeights()):s=new rn(r,o),s}createCurve(e,n){const t=e.children.reduce(function(r,o){return n.has(o.ID)&&(r=n.get(o.ID)),r},null),s=new tn({color:3342591,linewidth:1});return new on(t,s)}getTransformData(e,n){const t={};"InheritType"in n&&(t.inheritType=parseInt(n.InheritType.value)),"RotationOrder"in n?t.eulerOrder=Mn(n.RotationOrder.value):t.eulerOrder="ZYX","Lcl_Translation"in n&&(t.translation=n.Lcl_Translation.value),"PreRotation"in n&&(t.preRotation=n.PreRotation.value),"Lcl_Rotation"in n&&(t.rotation=n.Lcl_Rotation.value),"PostRotation"in n&&(t.postRotation=n.PostRotation.value),"Lcl_Scaling"in n&&(t.scale=n.Lcl_Scaling.value),"ScalingOffset"in n&&(t.scalingOffset=n.ScalingOffset.value),"ScalingPivot"in n&&(t.scalingPivot=n.ScalingPivot.value),"RotationOffset"in n&&(t.rotationOffset=n.RotationOffset.value),"RotationPivot"in n&&(t.rotationPivot=n.RotationPivot.value),e.userData.transformData=t}setLookAtProperties(e,n){"LookAtProperty"in n&&x.get(e.ID).children.forEach(function(s){if(s.relationship==="LookAtProperty"){const r=y.Objects.Model[s.ID];if("Lcl_Translation"in r){const o=r.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(o),K.add(e.target)):e.lookAt(new P().fromArray(o))}}})}bindSkeleton(e,n,t){const s=this.parsePoseNodes();for(const r in e){const o=e[r];x.get(parseInt(o.ID)).parents.forEach(function(i){if(n.has(i.ID)){const l=i.ID;x.get(l).parents.forEach(function(c){t.has(c.ID)&&t.get(c.ID).bind(new an(o.bones),s[c.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in y.Objects){const n=y.Objects.Pose;for(const t in n)if(n[t].attrType==="BindPose"&&n[t].NbPoseNodes>0){const s=n[t].PoseNode;Array.isArray(s)?s.forEach(function(r){e[r.Node]=new w().fromArray(r.Matrix.a)}):e[s.Node]=new w().fromArray(s.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in y&&"AmbientColor"in y.GlobalSettings){const e=y.GlobalSettings.AmbientColor.value,n=e[0],t=e[1],s=e[2];if(n!==0||t!==0||s!==0){const r=new U(n,t,s);K.add(new As(r,1))}}}}class Er{parse(e){const n=new Map;if("Geometry"in y.Objects){const t=y.Objects.Geometry;for(const s in t){const r=x.get(parseInt(s)),o=this.parseGeometry(r,t[s],e);n.set(parseInt(s),o)}}return n}parseGeometry(e,n,t){switch(n.attrType){case"Mesh":return this.parseMeshGeometry(e,n,t);case"NurbsCurve":return this.parseNurbsGeometry(n)}}parseMeshGeometry(e,n,t){const s=t.skeletons,r=[],o=e.parents.map(function(c){return y.Objects.Model[c.ID]});if(o.length===0)return;const a=e.children.reduce(function(c,h){return s[h.ID]!==void 0&&(c=s[h.ID]),c},null);e.children.forEach(function(c){t.morphTargets[c.ID]!==void 0&&r.push(t.morphTargets[c.ID])});const i=o[0],l={};"RotationOrder"in i&&(l.eulerOrder=Mn(i.RotationOrder.value)),"InheritType"in i&&(l.inheritType=parseInt(i.InheritType.value)),"GeometricTranslation"in i&&(l.translation=i.GeometricTranslation.value),"GeometricRotation"in i&&(l.rotation=i.GeometricRotation.value),"GeometricScaling"in i&&(l.scale=i.GeometricScaling.value);const A=Fn(l);return this.genGeometry(n,a,r,A)}genGeometry(e,n,t,s){const r=new Fe;e.attrName&&(r.name=e.attrName);const o=this.parseGeoNode(e,n),a=this.genBuffers(o),i=new me(a.vertex,3);if(i.applyMatrix4(s),r.setAttribute("position",i),a.colors.length>0&&r.setAttribute("color",new me(a.colors,3)),n&&(r.setAttribute("skinIndex",new us(a.weightsIndices,4)),r.setAttribute("skinWeight",new me(a.vertexWeights,4)),r.FBX_Deformer=n),a.normal.length>0){const l=new hs().getNormalMatrix(s),A=new me(a.normal,3);A.applyNormalMatrix(l),r.setAttribute("normal",A)}if(a.uvs.forEach(function(l,A){Bs==="uv2"&&A++;const c=A===0?"uv":`uv${A}`;r.setAttribute(c,new me(a.uvs[A],2))}),o.material&&o.material.mappingType!=="AllSame"){let l=a.materialIndex[0],A=0;if(a.materialIndex.forEach(function(c,h){c!==l&&(r.addGroup(A,h-A,l),l=c,A=h)}),r.groups.length>0){const c=r.groups[r.groups.length-1],h=c.start+c.count;h!==a.materialIndex.length&&r.addGroup(h,a.materialIndex.length-h,l)}r.groups.length===0&&r.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(r,e,t,s),r}parseGeoNode(e,n){const t={};if(t.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],t.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(t.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(t.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(t.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){t.uv=[];let s=0;for(;e.LayerElementUV[s];)e.LayerElementUV[s].UV&&t.uv.push(this.parseUVs(e.LayerElementUV[s])),s++}return t.weightTable={},n!==null&&(t.skeleton=n,n.rawBones.forEach(function(s,r){s.indices.forEach(function(o,a){t.weightTable[o]===void 0&&(t.weightTable[o]=[]),t.weightTable[o].push({id:r,weight:s.weights[a]})})})),t}genBuffers(e){const n={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let t=0,s=0,r=!1,o=[],a=[],i=[],l=[],A=[],c=[];const h=this;return e.vertexIndices.forEach(function(B,f){let d,m=!1;B<0&&(B=B^-1,m=!0);let g=[],E=[];if(o.push(B*3,B*3+1,B*3+2),e.color){const F=We(f,t,B,e.color);i.push(F[0],F[1],F[2])}if(e.skeleton){if(e.weightTable[B]!==void 0&&e.weightTable[B].forEach(function(F){E.push(F.weight),g.push(F.id)}),E.length>4){r||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),r=!0);const F=[0,0,0,0],M=[0,0,0,0];E.forEach(function(b,G){let H=b,v=g[G];M.forEach(function(S,I,Z){if(H>S){Z[I]=H,H=S;const se=F[I];F[I]=v,v=se}})}),g=F,E=M}for(;E.length<4;)E.push(0),g.push(0);for(let F=0;F<4;++F)A.push(E[F]),c.push(g[F])}if(e.normal){const F=We(f,t,B,e.normal);a.push(F[0],F[1],F[2])}e.material&&e.material.mappingType!=="AllSame"&&(d=We(f,t,B,e.material)[0]),e.uv&&e.uv.forEach(function(F,M){const b=We(f,t,B,F);l[M]===void 0&&(l[M]=[]),l[M].push(b[0]),l[M].push(b[1])}),s++,m&&(h.genFace(n,e,o,d,a,i,l,A,c,s),t++,s=0,o=[],a=[],i=[],l=[],A=[],c=[])}),n}genFace(e,n,t,s,r,o,a,i,l,A){for(let c=2;c<A;c++)e.vertex.push(n.vertexPositions[t[0]]),e.vertex.push(n.vertexPositions[t[1]]),e.vertex.push(n.vertexPositions[t[2]]),e.vertex.push(n.vertexPositions[t[(c-1)*3]]),e.vertex.push(n.vertexPositions[t[(c-1)*3+1]]),e.vertex.push(n.vertexPositions[t[(c-1)*3+2]]),e.vertex.push(n.vertexPositions[t[c*3]]),e.vertex.push(n.vertexPositions[t[c*3+1]]),e.vertex.push(n.vertexPositions[t[c*3+2]]),n.skeleton&&(e.vertexWeights.push(i[0]),e.vertexWeights.push(i[1]),e.vertexWeights.push(i[2]),e.vertexWeights.push(i[3]),e.vertexWeights.push(i[(c-1)*4]),e.vertexWeights.push(i[(c-1)*4+1]),e.vertexWeights.push(i[(c-1)*4+2]),e.vertexWeights.push(i[(c-1)*4+3]),e.vertexWeights.push(i[c*4]),e.vertexWeights.push(i[c*4+1]),e.vertexWeights.push(i[c*4+2]),e.vertexWeights.push(i[c*4+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[(c-1)*4]),e.weightsIndices.push(l[(c-1)*4+1]),e.weightsIndices.push(l[(c-1)*4+2]),e.weightsIndices.push(l[(c-1)*4+3]),e.weightsIndices.push(l[c*4]),e.weightsIndices.push(l[c*4+1]),e.weightsIndices.push(l[c*4+2]),e.weightsIndices.push(l[c*4+3])),n.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[(c-1)*3]),e.colors.push(o[(c-1)*3+1]),e.colors.push(o[(c-1)*3+2]),e.colors.push(o[c*3]),e.colors.push(o[c*3+1]),e.colors.push(o[c*3+2])),n.material&&n.material.mappingType!=="AllSame"&&(e.materialIndex.push(s),e.materialIndex.push(s),e.materialIndex.push(s)),n.normal&&(e.normal.push(r[0]),e.normal.push(r[1]),e.normal.push(r[2]),e.normal.push(r[(c-1)*3]),e.normal.push(r[(c-1)*3+1]),e.normal.push(r[(c-1)*3+2]),e.normal.push(r[c*3]),e.normal.push(r[c*3+1]),e.normal.push(r[c*3+2])),n.uv&&n.uv.forEach(function(h,B){e.uvs[B]===void 0&&(e.uvs[B]=[]),e.uvs[B].push(a[B][0]),e.uvs[B].push(a[B][1]),e.uvs[B].push(a[B][(c-1)*2]),e.uvs[B].push(a[B][(c-1)*2+1]),e.uvs[B].push(a[B][c*2]),e.uvs[B].push(a[B][c*2+1])})}addMorphTargets(e,n,t,s){if(t.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const r=this;t.forEach(function(o){o.rawTargets.forEach(function(a){const i=y.Objects.Geometry[a.geoID];i!==void 0&&r.genMorphGeometry(e,n,i,s,a.name)})})}genMorphGeometry(e,n,t,s,r){const o=n.PolygonVertexIndex!==void 0?n.PolygonVertexIndex.a:[],a=t.Vertices!==void 0?t.Vertices.a:[],i=t.Indexes!==void 0?t.Indexes.a:[],l=e.attributes.position.count*3,A=new Float32Array(l);for(let f=0;f<i.length;f++){const d=i[f]*3;A[d]=a[f*3],A[d+1]=a[f*3+1],A[d+2]=a[f*3+2]}const c={vertexIndices:o,vertexPositions:A},h=this.genBuffers(c),B=new me(h.vertex,3);B.name=r||t.attrName,B.applyMatrix4(s),e.morphAttributes.position.push(B)}parseNormals(e){const n=e.MappingInformationType,t=e.ReferenceInformationType,s=e.Normals.a;let r=[];return t==="IndexToDirect"&&("NormalIndex"in e?r=e.NormalIndex.a:"NormalsIndex"in e&&(r=e.NormalsIndex.a)),{dataSize:3,buffer:s,indices:r,mappingType:n,referenceType:t}}parseUVs(e){const n=e.MappingInformationType,t=e.ReferenceInformationType,s=e.UV.a;let r=[];return t==="IndexToDirect"&&(r=e.UVIndex.a),{dataSize:2,buffer:s,indices:r,mappingType:n,referenceType:t}}parseVertexColors(e){const n=e.MappingInformationType,t=e.ReferenceInformationType,s=e.Colors.a;let r=[];return t==="IndexToDirect"&&(r=e.ColorIndex.a),{dataSize:4,buffer:s,indices:r,mappingType:n,referenceType:t}}parseMaterialIndices(e){const n=e.MappingInformationType,t=e.ReferenceInformationType;if(n==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:t};const s=e.Materials.a,r=[];for(let o=0;o<s.length;++o)r.push(o);return{dataSize:1,buffer:s,indices:r,mappingType:n,referenceType:t}}parseNurbsGeometry(e){if(jt===void 0)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new Fe;const n=parseInt(e.Order);if(isNaN(n))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Fe;const t=n-1,s=e.KnotVector.a,r=[],o=e.Points.a;for(let c=0,h=o.length;c<h;c+=4)r.push(new $e().fromArray(o,c));let a,i;if(e.Form==="Closed")r.push(r[0]);else if(e.Form==="Periodic"){a=t,i=s.length-1-a;for(let c=0;c<t;++c)r.push(r[c])}const A=new jt(t,s,r,a,i).getPoints(r.length*12);return new Fe().setFromPoints(A)}}class Fr{parse(){const e=[],n=this.parseClips();if(n!==void 0)for(const t in n){const s=n[t],r=this.addClip(s);e.push(r)}return e}parseClips(){if(y.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const n=this.parseAnimationLayers(e);return this.parseAnimStacks(n)}parseAnimationCurveNodes(){const e=y.Objects.AnimationCurveNode,n=new Map;for(const t in e){const s=e[t];if(s.attrName.match(/S|R|T|DeformPercent/)!==null){const r={id:s.id,attr:s.attrName,curves:{}};n.set(r.id,r)}}return n}parseAnimationCurves(e){const n=y.Objects.AnimationCurve;for(const t in n){const s={id:n[t].id,times:n[t].KeyTime.a.map(Gr),values:n[t].KeyValueFloat.a},r=x.get(s.id);if(r!==void 0){const o=r.parents[0].ID,a=r.parents[0].relationship;a.match(/X/)?e.get(o).curves.x=s:a.match(/Y/)?e.get(o).curves.y=s:a.match(/Z/)?e.get(o).curves.z=s:a.match(/d|DeformPercent/)&&e.has(o)&&(e.get(o).curves.morph=s)}}}parseAnimationLayers(e){const n=y.Objects.AnimationLayer,t=new Map;for(const s in n){const r=[],o=x.get(parseInt(s));o!==void 0&&(o.children.forEach(function(i,l){if(e.has(i.ID)){const A=e.get(i.ID);if(A.curves.x!==void 0||A.curves.y!==void 0||A.curves.z!==void 0){if(r[l]===void 0){const c=x.get(i.ID).parents.filter(function(h){return h.relationship!==void 0})[0].ID;if(c!==void 0){const h=y.Objects.Model[c.toString()];if(h===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",i);return}const B={modelName:h.attrName?Ne.sanitizeNodeName(h.attrName):"",ID:h.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};K.traverse(function(f){f.ID===h.id&&(B.transform=f.matrix,f.userData.transformData&&(B.eulerOrder=f.userData.transformData.eulerOrder))}),B.transform||(B.transform=new w),"PreRotation"in h&&(B.preRotation=h.PreRotation.value),"PostRotation"in h&&(B.postRotation=h.PostRotation.value),r[l]=B}}r[l]&&(r[l][A.attr]=A)}else if(A.curves.morph!==void 0){if(r[l]===void 0){const c=x.get(i.ID).parents.filter(function(g){return g.relationship!==void 0})[0].ID,h=x.get(c).parents[0].ID,B=x.get(h).parents[0].ID,f=x.get(B).parents[0].ID,d=y.Objects.Model[f],m={modelName:d.attrName?Ne.sanitizeNodeName(d.attrName):"",morphName:y.Objects.Deformer[c].attrName};r[l]=m}r[l][A.attr]=A}}}),t.set(parseInt(s),r))}return t}parseAnimStacks(e){const n=y.Objects.AnimationStack,t={};for(const s in n){const r=x.get(parseInt(s)).children;r.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=e.get(r[0].ID);t[s]={name:n[s].attrName,layer:o}}return t}addClip(e){let n=[];const t=this;return e.layer.forEach(function(s){n=n.concat(t.generateTracks(s))}),new cn(e.name,-1,n)}generateTracks(e){const n=[];let t=new P,s=new le,r=new P;if(e.transform&&e.transform.decompose(t,s,r),t=t.toArray(),s=new Oe().setFromQuaternion(s,e.eulerOrder).toArray(),r=r.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,t,"position");o!==void 0&&n.push(o)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,s,e.preRotation,e.postRotation,e.eulerOrder);o!==void 0&&n.push(o)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,r,"scale");o!==void 0&&n.push(o)}if(e.DeformPercent!==void 0){const o=this.generateMorphTrack(e);o!==void 0&&n.push(o)}return n}generateVectorTrack(e,n,t,s){const r=this.getTimesForAllAxes(n),o=this.getKeyframeTrackValues(r,n,t);return new mt(e+"."+s,r,o)}generateRotationTrack(e,n,t,s,r,o){n.x!==void 0&&(this.interpolateRotations(n.x),n.x.values=n.x.values.map(Y.degToRad)),n.y!==void 0&&(this.interpolateRotations(n.y),n.y.values=n.y.values.map(Y.degToRad)),n.z!==void 0&&(this.interpolateRotations(n.z),n.z.values=n.z.values.map(Y.degToRad));const a=this.getTimesForAllAxes(n),i=this.getKeyframeTrackValues(a,n,t);s!==void 0&&(s=s.map(Y.degToRad),s.push(o),s=new Oe().fromArray(s),s=new le().setFromEuler(s)),r!==void 0&&(r=r.map(Y.degToRad),r.push(o),r=new Oe().fromArray(r),r=new le().setFromEuler(r).invert());const l=new le,A=new Oe,c=[];for(let h=0;h<i.length;h+=3)A.set(i[h],i[h+1],i[h+2],o),l.setFromEuler(A),s!==void 0&&l.premultiply(s),r!==void 0&&l.multiply(r),l.toArray(c,h/3*4);return new gt(e+".quaternion",a,c)}generateMorphTrack(e){const n=e.DeformPercent.curves.morph,t=n.values.map(function(r){return r/100}),s=K.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Ct(e.modelName+".morphTargetInfluences["+s+"]",n.times,t)}getTimesForAllAxes(e){let n=[];if(e.x!==void 0&&(n=n.concat(e.x.times)),e.y!==void 0&&(n=n.concat(e.y.times)),e.z!==void 0&&(n=n.concat(e.z.times)),n=n.sort(function(t,s){return t-s}),n.length>1){let t=1,s=n[0];for(let r=1;r<n.length;r++){const o=n[r];o!==s&&(n[t]=o,s=o,t++)}n=n.slice(0,t)}return n}getKeyframeTrackValues(e,n,t){const s=t,r=[];let o=-1,a=-1,i=-1;return e.forEach(function(l){if(n.x&&(o=n.x.times.indexOf(l)),n.y&&(a=n.y.times.indexOf(l)),n.z&&(i=n.z.times.indexOf(l)),o!==-1){const A=n.x.values[o];r.push(A),s[0]=A}else r.push(s[0]);if(a!==-1){const A=n.y.values[a];r.push(A),s[1]=A}else r.push(s[1]);if(i!==-1){const A=n.z.values[i];r.push(A),s[2]=A}else r.push(s[2])}),r}interpolateRotations(e){for(let n=1;n<e.values.length;n++){const t=e.values[n-1],s=e.values[n]-t,r=Math.abs(s);if(r>=180){const o=r/180,a=s/o;let i=t+a;const l=e.times[n-1],c=(e.times[n]-l)/o;let h=l+c;const B=[],f=[];for(;h<e.times[n];)B.push(h),h+=c,f.push(i),i+=a;e.times=Zt(e.times,n,B),e.values=Zt(e.values,n,f)}}}}class Mr{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,n){this.currentProp=e,this.currentPropName=n}parse(e){this.currentIndent=0,this.allNodes=new En,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const n=this,t=e.split(/[\r\n]+/);return t.forEach(function(s,r){const o=s.match(/^[\s\t]*;/),a=s.match(/^[\s\t]*$/);if(o||a)return;const i=s.match("^\\t{"+n.currentIndent+"}(\\w+):(.*){",""),l=s.match("^\\t{"+n.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),A=s.match("^\\t{"+(n.currentIndent-1)+"}}");i?n.parseNodeBegin(s,i):l?n.parseNodeProperty(s,l,t[++r]):A?n.popStack():s.match(/^[^\s\t}]/)&&n.parseNodePropertyContinued(s)}),this.allNodes}parseNodeBegin(e,n){const t=n[1].trim().replace(/^"/,"").replace(/"$/,""),s=n[2].split(",").map(function(i){return i.trim().replace(/^"/,"").replace(/"$/,"")}),r={name:t},o=this.parseNodeAttr(s),a=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(t,r):t in a?(t==="PoseNode"?a.PoseNode.push(r):a[t].id!==void 0&&(a[t]={},a[t][a[t].id]=a[t]),o.id!==""&&(a[t][o.id]=r)):typeof o.id=="number"?(a[t]={},a[t][o.id]=r):t!=="Properties70"&&(t==="PoseNode"?a[t]=[r]:a[t]=r),typeof o.id=="number"&&(r.id=o.id),o.name!==""&&(r.attrName=o.name),o.type!==""&&(r.attrType=o.type),this.pushStack(r)}parseNodeAttr(e){let n=e[0];e[0]!==""&&(n=parseInt(e[0]),isNaN(n)&&(n=e[0]));let t="",s="";return e.length>1&&(t=e[1].replace(/^(\w+)::/,""),s=e[2]),{id:n,name:t,type:s}}parseNodeProperty(e,n,t){let s=n[1].replace(/^"/,"").replace(/"$/,"").trim(),r=n[2].replace(/^"/,"").replace(/"$/,"").trim();s==="Content"&&r===","&&(r=t.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if(o.name==="Properties70"){this.parseNodeSpecialProperty(e,s,r);return}if(s==="C"){const i=r.split(",").slice(1),l=parseInt(i[0]),A=parseInt(i[1]);let c=r.split(",").slice(3);c=c.map(function(h){return h.trim().replace(/^"/,"")}),s="connections",r=[l,A],Rr(r,c),o[s]===void 0&&(o[s]=[])}s==="Node"&&(o.id=r),s in o&&Array.isArray(o[s])?o[s].push(r):s!=="a"?o[s]=r:o.a=r,this.setCurrentProp(o,s),s==="a"&&r.slice(-1)!==","&&(o.a=ut(r))}parseNodePropertyContinued(e){const n=this.getCurrentNode();n.a+=e,e.slice(-1)!==","&&(n.a=ut(n.a))}parseNodeSpecialProperty(e,n,t){const s=t.split('",').map(function(A){return A.trim().replace(/^\"/,"").replace(/\s/,"_")}),r=s[0],o=s[1],a=s[2],i=s[3];let l=s[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=ut(l);break}this.getPrevNode()[r]={type:o,type2:a,flag:i,value:l},this.setCurrentProp(this.getPrevNode(),r)}}class Ir{parse(e){const n=new Qt(e);n.skip(23);const t=n.getUint32();if(t<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+t);const s=new En;for(;!this.endOfContent(n);){const r=this.parseNode(n,t);r!==null&&s.add(r.name,r)}return s}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,n){const t={},s=n>=7500?e.getUint64():e.getUint32(),r=n>=7500?e.getUint64():e.getUint32();n>=7500?e.getUint64():e.getUint32();const o=e.getUint8(),a=e.getString(o);if(s===0)return null;const i=[];for(let h=0;h<r;h++)i.push(this.parseProperty(e));const l=i.length>0?i[0]:"",A=i.length>1?i[1]:"",c=i.length>2?i[2]:"";for(t.singleProperty=r===1&&e.getOffset()===s;s>e.getOffset();){const h=this.parseNode(e,n);h!==null&&this.parseSubNode(a,t,h)}return t.propertyList=i,typeof l=="number"&&(t.id=l),A!==""&&(t.attrName=A),c!==""&&(t.attrType=c),a!==""&&(t.name=a),t}parseSubNode(e,n,t){if(t.singleProperty===!0){const s=t.propertyList[0];Array.isArray(s)?(n[t.name]=t,t.a=s):n[t.name]=s}else if(e==="Connections"&&t.name==="C"){const s=[];t.propertyList.forEach(function(r,o){o!==0&&s.push(r)}),n.connections===void 0&&(n.connections=[]),n.connections.push(s)}else if(t.name==="Properties70")Object.keys(t).forEach(function(r){n[r]=t[r]});else if(e==="Properties70"&&t.name==="P"){let s=t.propertyList[0],r=t.propertyList[1];const o=t.propertyList[2],a=t.propertyList[3];let i;s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),r==="Color"||r==="ColorRGB"||r==="Vector"||r==="Vector3D"||r.indexOf("Lcl_")===0?i=[t.propertyList[4],t.propertyList[5],t.propertyList[6]]:i=t.propertyList[4],n[s]={type:r,type2:o,flag:a,value:i}}else n[t.name]===void 0?typeof t.id=="number"?(n[t.name]={},n[t.name][t.id]=t):n[t.name]=t:t.name==="PoseNode"?(Array.isArray(n[t.name])||(n[t.name]=[n[t.name]]),n[t.name].push(t)):n[t.name][t.id]===void 0&&(n[t.name][t.id]=t)}parseProperty(e){const n=e.getString(1);let t;switch(n){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return t=e.getUint32(),e.getArrayBuffer(t);case"S":return t=e.getUint32(),e.getString(t);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const s=e.getUint32(),r=e.getUint32(),o=e.getUint32();if(r===0)switch(n){case"b":case"c":return e.getBooleanArray(s);case"d":return e.getFloat64Array(s);case"f":return e.getFloat32Array(s);case"i":return e.getInt32Array(s);case"l":return e.getInt64Array(s)}const a=Ds(new Uint8Array(e.getArrayBuffer(o))),i=new Qt(a.buffer);switch(n){case"b":case"c":return i.getBooleanArray(s);case"d":return i.getFloat64Array(s);case"f":return i.getFloat32Array(s);case"i":return i.getInt32Array(s);case"l":return i.getInt64Array(s)}default:throw new Error("THREE.FBXLoader: Unknown property type "+n)}}}class Qt{constructor(e,n){this.dv=new DataView(e),this.offset=0,this.littleEndian=n!==void 0?n:!0}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const n=[];for(let t=0;t<e;t++)n.push(this.getBoolean());return n}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const n=[];for(let t=0;t<e;t++)n.push(this.getInt32());return n}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n&2147483648?(n=~n&4294967295,e=~e&4294967295,e===4294967295&&(n=n+1&4294967295),e=e+1&4294967295,-(n*4294967296+e)):n*4294967296+e}getInt64Array(e){const n=[];for(let t=0;t<e;t++)n.push(this.getInt64());return n}getUint64(){let e,n;return this.littleEndian?(e=this.getUint32(),n=this.getUint32()):(n=this.getUint32(),e=this.getUint32()),n*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const n=[];for(let t=0;t<e;t++)n.push(this.getFloat32());return n}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const n=[];for(let t=0;t<e;t++)n.push(this.getFloat64());return n}getArrayBuffer(e){const n=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,n}getString(e){let n=[];for(let s=0;s<e;s++)n[s]=this.getUint8();const t=n.indexOf(0);return t>=0&&(n=n.slice(0,t)),Te(new Uint8Array(n))}}class En{add(e,n){this[e]=n}}function Tr(u){const e="Kaydara FBX Binary  \0";return u.byteLength>=e.length&&e===In(u,0,e.length)}function Dr(u){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function t(s){const r=u[s-1];return u=u.slice(n+s),n++,r}for(let s=0;s<e.length;++s)if(t(1)===e[s])return!1;return!0}function Yt(u){const e=/FBXVersion: (\d+)/,n=u.match(e);if(n)return parseInt(n[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function Gr(u){return u/46186158e3}const yr=[];function We(u,e,n,t){let s;switch(t.mappingType){case"ByPolygonVertex":s=u;break;case"ByPolygon":s=e;break;case"ByVertice":s=n;break;case"AllSame":s=t.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+t.mappingType)}t.referenceType==="IndexToDirect"&&(s=t.indices[s]);const r=s*t.dataSize,o=r+t.dataSize;return br(yr,t.buffer,r,o)}const At=new Oe,Ce=new P;function Fn(u){const e=new w,n=new w,t=new w,s=new w,r=new w,o=new w,a=new w,i=new w,l=new w,A=new w,c=new w,h=new w,B=u.inheritType?u.inheritType:0;if(u.translation&&e.setPosition(Ce.fromArray(u.translation)),u.preRotation){const I=u.preRotation.map(Y.degToRad);I.push(u.eulerOrder),n.makeRotationFromEuler(At.fromArray(I))}if(u.rotation){const I=u.rotation.map(Y.degToRad);I.push(u.eulerOrder),t.makeRotationFromEuler(At.fromArray(I))}if(u.postRotation){const I=u.postRotation.map(Y.degToRad);I.push(u.eulerOrder),s.makeRotationFromEuler(At.fromArray(I)),s.invert()}u.scale&&r.scale(Ce.fromArray(u.scale)),u.scalingOffset&&a.setPosition(Ce.fromArray(u.scalingOffset)),u.scalingPivot&&o.setPosition(Ce.fromArray(u.scalingPivot)),u.rotationOffset&&i.setPosition(Ce.fromArray(u.rotationOffset)),u.rotationPivot&&l.setPosition(Ce.fromArray(u.rotationPivot)),u.parentMatrixWorld&&(c.copy(u.parentMatrix),A.copy(u.parentMatrixWorld));const f=n.clone().multiply(t).multiply(s),d=new w;d.extractRotation(A);const m=new w;m.copyPosition(A);const g=m.clone().invert().multiply(A),E=d.clone().invert().multiply(g),F=r,M=new w;if(B===0)M.copy(d).multiply(f).multiply(E).multiply(F);else if(B===1)M.copy(d).multiply(E).multiply(f).multiply(F);else{const Z=new w().scale(new P().setFromMatrixScale(c)).clone().invert(),se=E.clone().multiply(Z);M.copy(d).multiply(f).multiply(se).multiply(F)}const b=l.clone().invert(),G=o.clone().invert();let H=e.clone().multiply(i).multiply(l).multiply(n).multiply(t).multiply(s).multiply(b).multiply(a).multiply(o).multiply(r).multiply(G);const v=new w().copyPosition(H),S=A.clone().multiply(v);return h.copyPosition(S),H=h.clone().multiply(M),H.premultiply(A.invert()),H}function Mn(u){u=u||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return u===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[u]}function ut(u){return u.split(",").map(function(n){return parseFloat(n)})}function In(u,e,n){return e===void 0&&(e=0),n===void 0&&(n=u.byteLength),Te(new Uint8Array(u,e,n))}function Rr(u,e){for(let n=0,t=u.length,s=e.length;n<s;n++,t++)u[t]=e[n]}function br(u,e,n,t){for(let s=n,r=0;s<t;s++,r++)u[r]=e[s];return u}function Zt(u,e,n){return u.slice(0,e).concat(n).concat(u.slice(e))}const ht=new WeakMap;class Sr extends Tt{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,n,t,s){const r=new Ke(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(n).catch(s)},t,s)}decodeDracoFile(e,n,t,s){const r={attributeIDs:t||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!t};this.decodeGeometry(e,r).then(n)}decodeGeometry(e,n){for(const i in n.attributeTypes){const l=n.attributeTypes[i];l.BYTES_PER_ELEMENT!==void 0&&(n.attributeTypes[i]=l.name)}const t=JSON.stringify(n);if(ht.has(e)){const i=ht.get(e);if(i.key===t)return i.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const r=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(r,o).then(i=>(s=i,new Promise((l,A)=>{s._callbacks[r]={resolve:l,reject:A},s.postMessage({type:"decode",id:r,taskConfig:n,buffer:e},[e])}))).then(i=>this._createGeometry(i.geometry));return a.catch(()=>!0).then(()=>{s&&r&&this._releaseTask(s,r)}),ht.set(e,{key:t,promise:a}),a}_createGeometry(e){const n=new Fe;e.index&&n.setIndex(new xe(e.index.array,1));for(let t=0;t<e.attributes.length;t++){const s=e.attributes[t],r=s.name,o=s.array,a=s.itemSize;n.setAttribute(r,new xe(o,a))}return n}_loadLibrary(e,n){const t=new Ke(this.manager);return t.setPath(this.decoderPath),t.setResponseType(n),t.setWithCredentials(this.withCredentials),new Promise((s,r)=>{t.load(e,s,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(t=>{const s=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const r=vr.toString(),o=["/* draco decoder */",s,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(r){const o=r.data;switch(o.type){case"decode":s._callbacks[o.id].resolve(o);break;case"error":s._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,r){return s._taskLoad>r._taskLoad?-1:1});const t=this.workerPool[this.workerPool.length-1];return t._taskCosts[e]=n,t._taskLoad+=n,t})}_releaseTask(e,n){e._taskLoad-=e._taskCosts[n],delete e._callbacks[n],delete e._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function vr(){let u,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":u=a.decoderConfig,e=new Promise(function(A){u.onModuleLoaded=function(c){A({draco:c})},DracoDecoderModule(u)});break;case"decode":const i=a.buffer,l=a.taskConfig;e.then(A=>{const c=A.draco,h=new c.Decoder,B=new c.DecoderBuffer;B.Init(new Int8Array(i),i.byteLength);try{const f=n(c,h,B,l),d=f.attributes.map(m=>m.array.buffer);f.index&&d.push(f.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:f},d)}catch(f){console.error(f),self.postMessage({type:"error",id:a.id,error:f.message})}finally{c.destroy(B),c.destroy(h)}});break}};function n(o,a,i,l){const A=l.attributeIDs,c=l.attributeTypes;let h,B;const f=a.GetEncodedGeometryType(i);if(f===o.TRIANGULAR_MESH)h=new o.Mesh,B=a.DecodeBufferToMesh(i,h);else if(f===o.POINT_CLOUD)h=new o.PointCloud,B=a.DecodeBufferToPointCloud(i,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!B.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+B.error_msg());const d={index:null,attributes:[]};for(const m in A){const g=self[c[m]];let E,F;if(l.useUniqueIDs)F=A[m],E=a.GetAttributeByUniqueId(h,F);else{if(F=a.GetAttributeId(h,o[A[m]]),F===-1)continue;E=a.GetAttribute(h,F)}d.attributes.push(s(o,a,h,m,g,E))}return f===o.TRIANGULAR_MESH&&(d.index=t(o,a,h)),o.destroy(h),d}function t(o,a,i){const A=i.num_faces()*3,c=A*4,h=o._malloc(c);a.GetTrianglesUInt32Array(i,c,h);const B=new Uint32Array(o.HEAPF32.buffer,h,A).slice();return o._free(h),{array:B,itemSize:1}}function s(o,a,i,l,A,c){const h=c.num_components(),f=i.num_points()*h,d=f*A.BYTES_PER_ELEMENT,m=r(o,A),g=o._malloc(d);a.GetAttributeDataArrayForAllPoints(i,c,m,d,g);const E=new A(o.HEAPF32.buffer,g,f).slice();return o._free(g),{name:l,array:E,itemSize:h}}function r(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let ze;const xr=()=>{if(ze)return ze;const u="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",e="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",n=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let s=u;WebAssembly.validate(n)&&(s=e);let r;const o=WebAssembly.instantiate(a(s),{}).then(c=>{r=c.instance,r.exports.__wasm_call_ctors()});function a(c){const h=new Uint8Array(c.length);for(let f=0;f<c.length;++f){const d=c.charCodeAt(f);h[f]=d>96?d-71:d>64?d-65:d>47?d+4:d>46?63:62}let B=0;for(let f=0;f<c.length;++f)h[B++]=h[f]<60?t[h[f]]:(h[f]-60)*64+h[++f];return h.buffer.slice(0,B)}function i(c,h,B,f,d,m){const g=r.exports.sbrk,E=B+3&-4,F=g(E*f),M=g(d.length),b=new Uint8Array(r.exports.memory.buffer);b.set(d,M);const G=c(F,B,f,M,d.length);if(G===0&&m&&m(F,E,f),h.set(b.subarray(F,F+B*f)),g(F-g(0)),G!==0)throw new Error(`Malformed buffer data: ${G}`)}const l={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},A={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return ze={ready:o,supported:!0,decodeVertexBuffer(c,h,B,f,d){i(r.exports.meshopt_decodeVertexBuffer,c,h,B,f,r.exports[l[d]])},decodeIndexBuffer(c,h,B,f){i(r.exports.meshopt_decodeIndexBuffer,c,h,B,f)},decodeIndexSequence(c,h,B,f){i(r.exports.meshopt_decodeIndexSequence,c,h,B,f)},decodeGltfBuffer(c,h,B,f,d,m){i(r.exports[A[d]],c,h,B,f,r.exports[l[m]])}},ze};export{Sr as D,Or as F,Pr as G,xr as M,wr as O};
